"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[593],{29744:function(t,i,s){s.d(i,{C2:function(){return ei},Mr:function(){return y}});var e,h,l,r,n,o,a,u,c,f,d,p,v,m,g,b,M,w,N,y,C=s(23816);function S(t,i){let s={0:[],1:[t.lineWidth,t.lineWidth],2:[2*t.lineWidth,2*t.lineWidth],3:[6*t.lineWidth,6*t.lineWidth],4:[t.lineWidth,4*t.lineWidth]}[i];t.setLineDash(s)}function x(t,i,s,e){t.beginPath();let h=t.lineWidth%2?.5:0;t.moveTo(s,i+h),t.lineTo(e,i+h),t.stroke()}function _(t,i){if(!t)throw Error("Assertion failed"+(i?": "+i:""))}function F(t){if(void 0===t)throw Error("Value is undefined");return t}function T(t){if(null===t)throw Error("Value is null");return t}function k(t){return T(F(t))}(e=d||(d={}))[e.Simple=0]="Simple",e[e.WithSteps=1]="WithSteps",e[e.Curved=2]="Curved",(h=p||(p={}))[h.Solid=0]="Solid",h[h.Dotted=1]="Dotted",h[h.Dashed=2]="Dashed",h[h.LargeDashed=3]="LargeDashed",h[h.SparseDotted=4]="SparseDotted";let E={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function I(t){return t<0?0:t>255?255:Math.round(t)||0}function O(t){return t<=0||t>0?t<0?0:t>1?1:Math.round(1e4*t)/1e4:0}let V=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,R=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,P=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,L=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function G(t){(t=t.toLowerCase())in E&&(t=E[t]);{let i=L.exec(t)||P.exec(t);if(i)return[I(parseInt(i[1],10)),I(parseInt(i[2],10)),I(parseInt(i[3],10)),O(i.length<5?1:parseFloat(i[4]))]}{let s=R.exec(t);if(s)return[I(parseInt(s[1],16)),I(parseInt(s[2],16)),I(parseInt(s[3],16)),1]}{let e=V.exec(t);if(e)return[I(17*parseInt(e[1],16)),I(17*parseInt(e[2],16)),I(17*parseInt(e[3],16)),1]}throw Error("Cannot parse color: ".concat(t))}function j(t){let i=G(t);return{t:"rgb(".concat(i[0],", ").concat(i[1],", ").concat(i[2],")"),i:.199*i[0]+.687*i[1]+.114*i[2]>160?"black":"white"}}class A{l(t,i,s){this.h.push({o:t,_:i,u:!0===s})}p(t){let i=this.h.findIndex(i=>t===i.o);i>-1&&this.h.splice(i,1)}v(t){this.h=this.h.filter(i=>i._!==t)}m(t,i){let s=[...this.h];this.h=this.h.filter(t=>!t.u),s.forEach(s=>s.o(t,i))}g(){return this.h.length>0}M(){this.h=[]}constructor(){this.h=[]}}function D(t){for(var i=arguments.length,s=Array(i>1?i-1:0),e=1;e<i;e++)s[e-1]=arguments[e];for(let h of s)for(let l in h)void 0!==h[l]&&("object"!=typeof h[l]||void 0===t[l]?t[l]=h[l]:D(t[l],h[l]));return t}function U(t){return"number"==typeof t&&isFinite(t)}function B(t){return"number"==typeof t&&t%1==0}function J(t){return"string"==typeof t}function z(t){return"boolean"==typeof t}function K(t){let i,s,e;if(!t||"object"!=typeof t)return t;for(s in i=Array.isArray(t)?[]:{},t)t.hasOwnProperty(s)&&(e=t[s],i[s]=e&&"object"==typeof e?K(e):e);return i}function W(t){return null!==t}function q(t){return null===t?void 0:t}let Z="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function H(t,i,s){return void 0===i&&(i=Z),"".concat(s=void 0!==s?"".concat(s," "):"").concat(t,"px ").concat(i)}class Y{V(){let t=this.S,i=this.F(),s=this.W();return t.T===i&&t.P===s||(t.T=i,t.P=s,t.D=H(i,s),t.I=Math.floor(i/3.5),t.N=t.I,t.R=Math.max(Math.ceil(i/2-t.C/2),0),t.A=Math.ceil(i/2+t.C/2),t.L=Math.round(i/10)),t.O=this.j(),this.S}j(){return this.B.V().layout.textColor}F(){return this.B.V().layout.fontSize}W(){return this.B.V().layout.fontFamily}constructor(t){this.S={k:1,C:4,T:NaN,D:"",P:"",O:"",N:0,R:0,A:0,I:0,L:0},this.B=t}}class ${H(t){this.$=t}U(t,i,s,e){this.$.forEach(h=>{t.save(),h.U(t,i,s,e),t.restore()})}constructor(){this.$=[]}}class Q{U(t,i,s,e){t.save(),t.scale(i,i),this.q(t,s,e),t.restore()}Y(t,i,s,e){t.save(),t.scale(i,i),this.X(t,s,e),t.restore()}X(t,i,s){}}class X extends Q{Z(t){this.K=t}q(t){if(null===this.K||null===this.K.G)return;let i=this.K.G,s=this.K,e=e=>{t.beginPath();for(let h=i.to-1;h>=i.from;--h){let l=s.J[h];t.moveTo(l.tt,l.it),t.arc(l.tt,l.it,e,0,2*Math.PI)}t.fill()};t.fillStyle=s.st,e(s.nt+2),t.fillStyle=s.et,e(s.nt)}constructor(){super(...arguments),this.K=null}}function tt(){return{J:[{tt:0,it:0,rt:0,ht:0}],et:"",st:"",nt:0,G:null}}let ti={from:0,to:1};class ts{dt(t){let i=this.B.ft();i.length!==this.ot.length&&(this._t=i.map(tt),this.ot=this._t.map(t=>{let i=new X;return i.Z(t),i}),this.lt.H(this.ot)),this.ut=!0}vt(t,i,s){return this.ut&&(this.wt(t),this.ut=!1),this.lt}wt(t){let i=this.B.ft(),s=this.ct.bt(),e=this.B.gt();i.forEach((i,h)=>{var l;let r=this._t[h],n=i.Mt(s);if(null===n||!i.St())return void(r.G=null);let o=T(i.yt());r.et=n.kt,r.nt=n.nt,r.J[0].ht=n.ht,r.J[0].it=i.Ct().xt(n.ht,o.Tt),r.st=null!==(l=n.Dt)&&void 0!==l?l:this.B.Pt(r.J[0].it/t),r.J[0].rt=s,r.J[0].tt=e.Ot(s),r.G=ti})}constructor(t,i){this.lt=new $,this.ot=[],this._t=[],this.ut=!0,this.B=t,this.ct=i,this.lt.H(this.ot)}}class te{U(t,i,s,e){if(null===this.Nt)return;let h=this.Nt.Rt.St,l=this.Nt.At.St;if(!h&&!l)return;t.save();let r=Math.round(this.Nt.tt*i),n=Math.round(this.Nt.it*i),o=Math.ceil(this.Nt.Et*i),a=Math.ceil(this.Nt.It*i);t.lineCap="butt",h&&r>=0&&(t.lineWidth=Math.floor(this.Nt.Rt.Lt*i),t.strokeStyle=this.Nt.Rt.O,t.fillStyle=this.Nt.Rt.O,S(t,this.Nt.Rt.Bt),function(t,i,s,e){t.beginPath();let h=t.lineWidth%2?.5:0;t.moveTo(i+h,0),t.lineTo(i+h,e),t.stroke()}(t,r,0,a)),l&&n>=0&&(t.lineWidth=Math.floor(this.Nt.At.Lt*i),t.strokeStyle=this.Nt.At.O,t.fillStyle=this.Nt.At.O,S(t,this.Nt.At.Bt),x(t,n,0,o)),t.restore()}constructor(t){this.Nt=t}}class th{dt(){this.ut=!0}vt(t,i){return this.ut&&(this.wt(),this.ut=!1),this.Ft}wt(){let t=this.zt.St(),i=T(this.zt.Wt()),s=i.jt().V().crosshair,e=this.Vt;e.At.St=t&&this.zt.$t(i),e.Rt.St=t&&this.zt.Ht(),e.At.Lt=s.horzLine.width,e.At.Bt=s.horzLine.style,e.At.O=s.horzLine.color,e.Rt.Lt=s.vertLine.width,e.Rt.Bt=s.vertLine.style,e.Rt.O=s.vertLine.color,e.Et=i.Ut(),e.It=i.qt(),e.tt=this.zt.Yt(),e.it=this.zt.Xt()}constructor(t){this.ut=!0,this.Vt={Rt:{Lt:1,Bt:0,O:"",St:!1},At:{Lt:1,Bt:0,O:"",St:!1},Et:0,It:0,tt:0,it:0},this.Ft=new te(this.Vt),this.zt=t}}function tl(t,i,s){t.save(),t.scale(i,i),s(),t.restore()}function tr(t,i,s,e,h,l){t.save(),t.globalCompositeOperation="copy",t.fillStyle=l,t.fillRect(i,s,e,h),t.restore()}function tn(t,i,s,e,h,l,r){t.save(),t.globalCompositeOperation="copy";let n=t.createLinearGradient(0,0,0,h);n.addColorStop(0,l),n.addColorStop(1,r),t.fillStyle=n,t.fillRect(i,s,e,h),t.restore()}class to{Z(t,i){this.Nt=t,this.Kt=i}U(t,i,s,e,h,l){if(!this.Nt.St)return;t.font=i.D;let r=this.Nt.Zt||!this.Nt.Gt?i.C:0,n=i.k,o=i.I,a=i.N,u=i.R,c=i.A,f=this.Nt.Jt,d=Math.ceil(s.Qt(t,f)),p=i.L,v=i.T+o+a,m=n+d+u+c+r,g=this.Kt.ti;this.Kt.ii&&(g=this.Kt.ii),g=Math.round(g);let b=g-Math.ceil(.5*v),M=b+v,w="right"===h,N=w?e:0,y=Math.ceil(e*l),C,S,x=N;if(t.fillStyle=this.Kt.t,t.lineWidth=1,t.lineCap="butt",f){w?(x=N-m,C=N-r,S=x+c):(x=N+m,C=N+r,S=N+n+r+u);let _=Math.max(1,Math.floor(l)),F=Math.max(1,Math.floor(n*l)),T=w?y:0,k=Math.round(b*l),E=Math.round(x*l),I=Math.round(g*l)-Math.floor(.5*l),O=I+_+(I-k),V=Math.round(C*l);t.save(),t.beginPath(),t.moveTo(T,k),t.lineTo(E,k),t.lineTo(E,O),t.lineTo(T,O),t.fill(),t.fillStyle=this.Nt.Dt,t.fillRect(w?y-F:0,k,F,O-k),this.Nt.Zt&&(t.fillStyle=this.Kt.O,t.fillRect(T,I,V-T,_)),t.textAlign="left",t.fillStyle=this.Kt.O,tl(t,l,()=>{t.fillText(f,S,M-a-p)}),t.restore()}}qt(t,i){return this.Nt.St?t.T+t.I+t.N:0}constructor(t,i){this.Z(t,i)}}class ta{Jt(){return this.li(),this.ni.Jt}ti(){return this.li(),this.si.ti}dt(){this.ut=!0}qt(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.max(this.ri.qt(t,i),this.hi.qt(t,i))}ai(){return this.si.ii||0}oi(t){this.si.ii=t}_i(){return this.li(),this.ni.St||this.ei.St}ui(){return this.li(),this.ni.St}vt(t){return this.li(),this.ni.Zt=this.ni.Zt&&t.V().ticksVisible,this.ei.Zt=this.ei.Zt&&t.V().ticksVisible,this.ri.Z(this.ni,this.si),this.hi.Z(this.ei,this.si),this.ri}ci(){return this.li(),this.ri.Z(this.ni,this.si),this.hi.Z(this.ei,this.si),this.hi}li(){this.ut&&(this.ni.Zt=!0,this.ei.Zt=!1,this.di(this.ni,this.ei,this.si))}constructor(t){this.si={ti:0,O:"#FFF",t:"#000"},this.ni={Jt:"",St:!1,Zt:!0,Gt:!1,Dt:""},this.ei={Jt:"",St:!1,Zt:!1,Gt:!0,Dt:""},this.ut=!0,this.ri=new(t||to)(this.ni,this.si),this.hi=new(t||to)(this.ei,this.si)}}class tu extends ta{di(t,i,s){t.St=!1;let e=this.zt.V().horzLine;if(!e.labelVisible)return;let h=this.fi.yt();if(!this.zt.St()||this.fi.vi()||null===h)return;let l=j(e.labelBackgroundColor);s.t=l.t,s.O=l.i;let r=this.pi(this.fi);s.ti=r.ti,t.Jt=this.fi.mi(r.ht,h),t.St=!0}constructor(t,i,s){super(),this.zt=t,this.fi=i,this.pi=s}}let tc=/[1-9]/g;class tf{Z(t){this.Nt=t}U(t,i,s){if(null===this.Nt||!1===this.Nt.St||0===this.Nt.Jt.length)return;t.font=i.D;let e=Math.round(i.wi.Qt(t,this.Nt.Jt,tc));if(e<=0)return;t.save();let h=i.bi,l=e+2*h,r=l/2,n=this.Nt.Ut,o=this.Nt.ti,a=Math.floor(o-r)+.5;a<0?(o+=Math.abs(0-a),a=Math.floor(o-r)+.5):a+l>n&&(o-=Math.abs(n-(a+l)),a=Math.floor(o-r)+.5);let u=a+l,c=0+i.k+i.I+i.T+i.N;t.fillStyle=this.Nt.t;let f=Math.round(a*s),d=Math.round(0*s);if(t.fillRect(f,d,Math.round(u*s)-f,Math.round(c*s)-d),this.Nt.Zt){let p=Math.round(this.Nt.ti*s),v=Math.round((d+i.k+i.C)*s);t.fillStyle=this.Nt.O,t.fillRect(p-Math.floor(.5*s),d,Math.max(1,Math.floor(s)),v-d)}let m=c-i.L-i.N;t.textAlign="left",t.fillStyle=this.Nt.O,tl(t,s,()=>{t.fillText(T(this.Nt).Jt,a+h,m)}),t.restore()}constructor(){this.Nt=null}}class td{dt(){this.ut=!0}vt(){return this.ut&&(this.wt(),this.ut=!1),this.Ft.Z(this.Vt),this.Ft}wt(){let t=this.Vt;t.St=!1;let i=this.ct.V().vertLine;if(!i.labelVisible)return;let s=this.gi.gt();if(s.vi())return;t.Ut=s.Ut();let e=this.pi();if(!e.rt)return;t.ti=e.ti;let h=s.Mi(this.ct.bt());t.Jt=s.Si(T(h)),t.St=!0;let l=j(i.labelBackgroundColor);t.t=l.t,t.O=l.i,t.Zt=s.V().ticksVisible}constructor(t,i,s){this.ut=!0,this.Ft=new tf,this.Vt={St:!1,t:"#4c525e",O:"white",Jt:"",Ut:0,ti:NaN,Zt:!0},this.ct=t,this.gi=i,this.pi=s}}class tp{xi(){return this.ki}Ci(t){this.ki=t}Ct(){return this.yi}Ti(t){this.yi=t}Di(){return[]}St(){return!0}constructor(){this.yi=null,this.ki=0}}(l=v||(v={}))[l.Normal=0]="Normal",l[l.Magnet=1]="Magnet";class tv extends tp{V(){return this.Fi}Yi(t,i){this.Bi=t,this.Vi=i}Xi(){this.Bi=NaN,this.Vi=NaN}Ki(){return this.Bi}Zi(){return this.Vi}Gi(t,i,s){this.Ei||(this.Ei=!0),this.Ri=!0,this.Ji(t,i,s)}bt(){return this.Ni}Yt(){return this.Ii}Xt(){return this.Li}St(){return this.Ri}Qi(){this.Ri=!1,this.ts(),this.Oi=NaN,this.Ii=NaN,this.Li=NaN,this.Pi=null,this.Xi()}ss(t){return null!==this.Pi?[this.qi,this.zi]:[]}$t(t){return t===this.Pi&&this.Fi.horzLine.visible}Ht(){return this.Fi.vertLine.visible}ns(t,i){this.Ri&&this.Pi===t||this.Ai.clear();let s=[];return this.Pi===t&&s.push(this.es(this.Ai,i,this.Wi)),s}Di(){return this.Ri?[this.Ui]:[]}Wt(){return this.Pi}rs(){this.qi.dt(),this.Ai.forEach(t=>t.dt()),this.Ui.dt(),this.zi.dt()}hs(t){return t&&!t.ji().vi()?t.ji():null}Ji(t,i,s){this.ls(t,i,s)&&this.rs()}ls(t,i,s){let e=this.Ii,h=this.Li,l=this.Oi,r=this.Ni,n=this.Pi,o=this.hs(s);this.Ni=t,this.Ii=isNaN(t)?NaN:this.gi.gt().Ot(t),this.Pi=s;let a=null!==o?o.yt():null;return null!==o&&null!==a?(this.Oi=i,this.Li=o.xt(i,a)):(this.Oi=NaN,this.Li=NaN),e!==this.Ii||h!==this.Li||r!==this.Ni||l!==this.Oi||n!==this.Pi}ts(){let t=this.gi.ft().map(t=>t._s().os()).filter(W),i=0===t.length?null:Math.max(...t);this.Ni=null!==i?i:NaN}es(t,i,s){let e=t.get(i);return void 0===e&&(e=new tu(this,i,s),t.set(i,e)),e}constructor(t,i){var s,e,h,l;super(),this.Pi=null,this.Oi=NaN,this.Ni=0,this.Ri=!0,this.Ai=new Map,this.Ei=!1,this.Ii=NaN,this.Li=NaN,this.Bi=NaN,this.Vi=NaN,this.gi=t,this.Fi=i,this.zi=new ts(t,this),this.Wi=(s=()=>this.Oi,e=()=>this.Li,t=>{let i=e(),h=s();if(t===T(this.Pi).ji())return{ht:h,ti:i};{let l=T(t.yt());return{ht:t.$i(i,l),ti:i}}});let r=(h=()=>this.Ni,l=()=>this.Yt(),()=>({rt:this.gi.gt().Hi(h()),ti:l()}));this.Ui=new td(this,t,r),this.qi=new th(this)}}function tm(t){return"left"===t||"right"===t}class tg{fs(t,i){var s;let e=void 0===(s=this.us.get(t))?i:{ps:Math.max(s.ps,i.ps),vs:s.vs||i.vs};this.us.set(t,e)}ws(){return this.ds}bs(t){let i=this.us.get(t);return void 0===i?{ps:this.ds}:{ps:Math.max(this.ds,i.ps),vs:i.vs}}gs(){this.cs=[{Ms:0}]}Ss(t){this.cs=[{Ms:1,Tt:t}]}ys(){this.cs=[{Ms:4}]}ks(t){this.cs.push({Ms:2,Tt:t})}xs(t){this.cs.push({Ms:3,Tt:t})}Cs(){return this.cs}Ts(t){for(let i of t.cs)this.Ds(i);this.ds=Math.max(this.ds,t.ds),t.us.forEach((t,i)=>{this.fs(i,t)})}Ds(t){switch(t.Ms){case 0:this.gs();break;case 1:this.Ss(t.Tt);break;case 2:this.ks(t.Tt);break;case 3:this.xs(t.Tt);break;case 4:this.ys()}}constructor(t){this.us=new Map,this.cs=[],this.ds=t}}function tb(t,i){if(!U(t))return"n/a";if(!B(i)||i<0||i>16)throw TypeError("invalid length");return 0===i?t.toString():("0000000000000000"+t.toString()).slice(-i)}class tM{format(t){let i=t<0?"−":"";return t=Math.abs(t),i+this.Ns(t)}Os(){if(this.Rs=0,this.fi>0&&this.Ps>0){let t=this.fi;for(;t>1;)t/=10,this.Rs++}}Ns(t){let i=this.fi/this.Ps,s=Math.floor(t),e="",h=void 0!==this.Rs?this.Rs:NaN;if(i>1){let l=+(Math.round(t*i)-s*i).toFixed(this.Rs);l>=i&&(l-=i,s+=1),e="."+tb(+l.toFixed(this.Rs)*this.Ps,h)}else s=Math.round(s*i)/i,h>0&&(e="."+tb(0,h));return s.toFixed(0)+e}constructor(t,i){if(i||(i=1),U(t)&&B(t)||(t=100),t<0)throw TypeError("invalid base");this.fi=t,this.Ps=i,this.Os()}}class tw extends tM{format(t){return"".concat(super.format(t),"%")}constructor(t=100){super(t)}}class tN{format(t){let i="";return t<0&&(i="-",t=-t),t<995?i+this.Es(t):t<999995?i+this.Es(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.Es(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.Es(t/1e9)+"B")}Es(t){let i=Math.pow(10,this.As);return((t=Math.round(t*i)/i)>=1e-15&&t<1?t.toFixed(this.As).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,(t,i)=>i)}constructor(t){this.As=t}}function ty(t,i,s,e){if(0===i.length)return;let h=i[e.from].tt,l=i[e.from].it;t.moveTo(h,l);for(let r=e.from+1;r<e.to;++r){let n=i[r];switch(s){case 0:t.lineTo(n.tt,n.it);break;case 1:t.lineTo(n.tt,i[r-1].it),t.lineTo(n.tt,n.it);break;case 2:{let[o,a]=tx(i,r-1,r);t.bezierCurveTo(o.tt,o.it,a.tt,a.it,n.tt,n.it)}}}}function tC(t,i){return{tt:t.tt-i.tt,it:t.it-i.it}}function tS(t,i){return{tt:t.tt/i,it:t.it/i}}function tx(t,i,s){var e,h;let l=Math.min(t.length-1,s+1);return[(e=t[i],h=tS(tC(t[s],t[Math.max(0,i-1)]),6),{tt:e.tt+h.tt,it:e.it+h.it}),tC(t[s],tS(tC(t[l],t[i]),6))]}class t_ extends Q{Z(t){this.K=t}q(t){if(null!==this.K&&0!==this.K.J.length&&null!==this.K.G){if(t.lineCap="butt",t.lineJoin="round",t.lineWidth=this.K.Lt,S(t,this.K.Bt),t.lineWidth=1,t.beginPath(),1===this.K.J.length){let i=this.K.J[0],s=this.K.Is/2;t.moveTo(i.tt-s,this.K.Ls),t.lineTo(i.tt-s,i.it),t.lineTo(i.tt+s,i.it),t.lineTo(i.tt+s,this.K.Ls)}else t.moveTo(this.K.J[this.K.G.from].tt,this.K.Ls),t.lineTo(this.K.J[this.K.G.from].tt,this.K.J[this.K.G.from].it),ty(t,this.K.J,this.K.Bs,this.K.G),this.K.G.to>this.K.G.from&&(t.lineTo(this.K.J[this.K.G.to-1].tt,this.K.Ls),t.lineTo(this.K.J[this.K.G.from].tt,this.K.Ls));t.closePath(),t.fillStyle=this.Vs(t),t.fill()}}constructor(){super(...arguments),this.K=null}}class tF extends t_{Vs(t){let i=this.K,s=t.createLinearGradient(0,0,0,i.Fs);return s.addColorStop(0,i.zs),s.addColorStop(1,i.Ws),s}}class tT extends Q{Z(t){this.K=t}q(t){if(null!==this.K&&0!==this.K.J.length&&null!==this.K.G){if(t.lineCap="butt",t.lineWidth=this.K.Lt,S(t,this.K.Bt),t.strokeStyle=this.js(t),t.lineJoin="round",1===this.K.J.length){t.beginPath();let i=this.K.J[0];t.moveTo(i.tt-this.K.Is/2,i.it),t.lineTo(i.tt+this.K.Is/2,i.it),void 0!==i.O&&(t.strokeStyle=i.O),t.stroke()}else this.$s(t,this.K)}}$s(t,i){t.beginPath(),ty(t,i.J,i.Bs,i.G),t.stroke()}constructor(){super(...arguments),this.K=null}}class tk extends tT{$s(t,i){var s,e;let{J:h,G:l,Bs:r,et:n}=i;if(0===h.length||null===l)return;t.beginPath();let o=h[l.from];t.moveTo(o.tt,o.it);let a=null!==(s=o.O)&&void 0!==s?s:n;t.strokeStyle=a;let u=i=>{t.stroke(),t.beginPath(),t.strokeStyle=i,a=i};for(let c=l.from+1;c<l.to;++c){let f=h[c],d=null!==(e=f.O)&&void 0!==e?e:n;switch(r){case 0:t.lineTo(f.tt,f.it);break;case 1:t.lineTo(f.tt,h[c-1].it),d!==a&&(u(d),t.lineTo(f.tt,h[c-1].it)),t.lineTo(f.tt,f.it);break;case 2:{let[p,v]=tx(h,c-1,c);t.bezierCurveTo(p.tt,p.it,v.tt,v.it,f.tt,f.it)}}1!==r&&d!==a&&(u(d),t.moveTo(f.tt,f.it))}t.stroke()}js(){return this.K.et}}function tE(t,i,s){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.length,l=h-e;for(;0<l;){let r=l>>1,n=e+r;s(t[n],i)?(e=n+1,l-=r+1):l=r}return e}function tI(t,i,s){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.length,l=h-e;for(;0<l;){let r=l>>1,n=e+r;s(i,t[n])?l=r:(e=n+1,l-=r+1)}return e}function tO(t,i){return t.rt<i}function tV(t,i){return t<i.rt}function tR(t,i,s){let e=i.Hs(),h=i.Us(),l=tE(t,e,tO),r=tI(t,h,tV);if(!s)return{from:l,to:r};let n=l,o=r;return l>0&&l<t.length&&t[l].rt>=e&&(n=l-1),r>0&&r<t.length&&t[r-1].rt<=h&&(o=r+1),{from:n,to:o}}class tP{dt(t){this.qs=!0,"data"===t&&(this.Ys=!0),"options"===t&&(this.Xs=!0)}tn(){this.Ys&&(this.sn(),this.Ys=!1),this.qs&&(this.nn(),this.qs=!1),this.Xs&&(this.en(),this.Xs=!1)}rn(){this.Zs=null}nn(){let t=this.Gs.Ct(),i=this.Js.gt();if(this.rn(),i.vi()||t.vi())return;let s=i.hn();if(null===s||0===this.Gs._s().ln())return;let e=this.Gs.yt();null!==e&&(this.Zs=tR(this.Ks,s,this.Qs),this.an(t,i,e.Tt))}constructor(t,i,s){this.qs=!0,this.Ys=!0,this.Xs=!0,this.Ks=[],this.Zs=null,this.Gs=t,this.Js=i,this.Qs=s}}class tL extends tP{an(t,i,s){i.on(this.Ks,q(this.Zs)),t._n(this.Ks,s,q(this.Zs))}un(t,i){return{rt:t,ht:i,tt:NaN,it:NaN}}en(){}sn(){let t=this.Gs.cn();this.Ks=this.Gs._s().dn().map(i=>{let s=i.Tt[3];return this.fn(i.pn,s,t)})}constructor(t,i){super(t,i,!0)}}class tG extends tL{vt(t,i){if(!this.Gs.St())return null;let s=this.Gs.V();return this.tn(),this.vn.Z({Bs:s.lineType,J:this.Ks,Bt:s.lineStyle,Lt:s.lineWidth,zs:s.topColor,Ws:s.bottomColor,Ls:t,Fs:t,G:this.Zs,Is:this.Js.gt().wn()}),this.mn.Z({Bs:s.lineType,J:this.Ks,et:s.lineColor,Bt:s.lineStyle,Lt:s.lineWidth,G:this.Zs,Is:this.Js.gt().wn()}),this.Ft}fn(t,i){return this.un(t,i)}constructor(t,i){super(t,i),this.Ft=new $,this.vn=new tF,this.mn=new tk,this.Ft.H([this.vn,this.mn])}}class tj{Z(t){this.Nt=t}U(t,i,s,e){if(null===this.Nt||0===this.Nt._s.length||null===this.Nt.G)return;this.bn=this.Mn(i),this.bn>=2&&Math.max(1,Math.floor(i))%2!=this.bn%2&&this.bn--,this.gn=this.Nt.Sn?Math.min(this.bn,Math.floor(i)):this.bn;let h=null,l=this.gn<=this.bn&&this.Nt.wn>=Math.floor(1.5*i);for(let r=this.Nt.G.from;r<this.Nt.G.to;++r){let n=this.Nt._s[r];h!==n.O&&(t.fillStyle=n.O,h=n.O);let o=Math.floor(.5*this.gn),a=Math.round(n.tt*i),u=a-o,c=this.gn,f=u+c-1,d=Math.min(n.yn,n.kn),p=Math.max(n.yn,n.kn),v=Math.round(d*i)-o,m=Math.round(p*i)+o,g=Math.max(m-v,this.gn);t.fillRect(u,v,c,g);let b=Math.ceil(1.5*this.bn);if(l){if(this.Nt.xn){let M=a-b,w=Math.max(v,Math.round(n.Cn*i)-o),N=w+c-1;N>v+g-1&&(w=(N=v+g-1)-c+1),t.fillRect(M,w,u-M,N-w+1)}let y=a+b,C=Math.max(v,Math.round(n.Tn*i)-o),S=C+c-1;S>v+g-1&&(C=(S=v+g-1)-c+1),t.fillRect(f+1,C,y-f,S-C+1)}}}Mn(t){return Math.max(Math.floor(t),Math.floor(Math.floor(.3*T(this.Nt).wn*t)))}constructor(){this.Nt=null,this.bn=0,this.gn=0}}class tA extends tP{an(t,i,s){i.on(this.Ks,q(this.Zs)),t.Dn(this.Ks,s,q(this.Zs))}Pn(t,i,s){return{rt:t,On:i.Tt[0],Nn:i.Tt[1],Rn:i.Tt[2],An:i.Tt[3],tt:NaN,Cn:NaN,yn:NaN,kn:NaN,Tn:NaN}}sn(){let t=this.Gs.cn();this.Ks=this.Gs._s().dn().map(i=>this.fn(i.pn,i,t))}constructor(t,i){super(t,i,!1)}}class tD extends tA{vt(t,i){if(!this.Gs.St())return null;let s=this.Gs.V();this.tn();let e={_s:this.Ks,wn:this.Js.gt().wn(),xn:s.openVisible,Sn:s.thinBars,G:this.Zs};return this.Ft.Z(e),this.Ft}en(){this.Ks.forEach(t=>{t.O=this.Gs.cn().In(t.rt).En})}fn(t,i,s){return Object.assign(Object.assign({},this.Pn(t,i,s)),{O:s.In(t).En})}constructor(){super(...arguments),this.Ft=new tj}}function tU(t,i,s){return Math.min(Math.max(t,i),s)}function tB(t){return t<=0?NaN:Math.log(t)/Math.log(10)}function tJ(t){let i=Math.ceil(t);return i%2!=0?i-1:i}function tz(t){let i=Math.ceil(t);return i%2==0?i-1:i}class tK extends t_{Vs(t){let i=this.K,s=t.createLinearGradient(0,0,0,i.Fs),e=tU(i.Ls/i.Fs,0,1);return s.addColorStop(0,i.Ln),s.addColorStop(e,i.Bn),s.addColorStop(e,i.Vn),s.addColorStop(1,i.Fn),s}}class tW extends tT{js(t){let i=this.K,s=t.createLinearGradient(0,0,0,i.Fs),e=tU(i.Ls/i.Fs,0,1);return s.addColorStop(0,i.zs),s.addColorStop(e,i.zs),s.addColorStop(e,i.Ws),s.addColorStop(1,i.Ws),s}}class tq extends tL{vt(t,i){if(!this.Gs.St())return null;let s=this.Gs.yt();if(null===s)return null;let e=this.Gs.V();this.tn();let h=this.Gs.Ct().xt(e.baseValue.price,s.Tt),l=this.Js.gt().wn();return this.zn.Z({J:this.Ks,Ln:e.topFillColor1,Bn:e.topFillColor2,Vn:e.bottomFillColor1,Fn:e.bottomFillColor2,Lt:e.lineWidth,Bt:e.lineStyle,Bs:e.lineType,Ls:h,Fs:t,G:this.Zs,Is:l}),this.Wn.Z({J:this.Ks,zs:e.topLineColor,Ws:e.bottomLineColor,Lt:e.lineWidth,Bt:e.lineStyle,Bs:e.lineType,Ls:h,Fs:t,G:this.Zs,Is:l}),this.lt}fn(t,i){return this.un(t,i)}constructor(t,i){super(t,i),this.zn=new tK,this.Wn=new tW,this.lt=new $,this.lt.H([this.zn,this.Wn])}}class tZ{Z(t){this.Nt=t}U(t,i,s,e){var h;if(null===this.Nt||0===this.Nt._s.length||null===this.Nt.G)return;this.bn=(h=this.Nt.wn)>=2.5&&h<=4?Math.floor(3*i):Math.max(Math.floor(i),Math.min(Math.floor(h*(1-.2*Math.atan(Math.max(4,h)-4)/(.5*Math.PI))*i),Math.floor(h*i))),this.bn>=2&&Math.floor(i)%2!=this.bn%2&&this.bn--;let l=this.Nt._s;this.Nt.jn&&this.$n(t,l,this.Nt.G,i),this.Nt.Hn&&this.Un(t,l,this.Nt.G,this.Nt.wn,i);let r=this.qn(i);(!this.Nt.Hn||this.bn>2*r)&&this.Yn(t,l,this.Nt.G,i)}$n(t,i,s,e){if(null===this.Nt)return;let h="",l=Math.min(Math.floor(e),Math.floor(this.Nt.wn*e));l=Math.max(Math.floor(e),Math.min(l,this.bn));let r=Math.floor(.5*l),n=null;for(let o=s.from;o<s.to;o++){let a=i[o];a.Xn!==h&&(t.fillStyle=a.Xn,h=a.Xn);let u=Math.round(Math.min(a.Cn,a.Tn)*e),c=Math.round(Math.max(a.Cn,a.Tn)*e),f=Math.round(a.yn*e),d=Math.round(a.kn*e),p=Math.round(e*a.tt)-r,v=p+l-1;null!==n&&(p=Math.min(p=Math.max(n+1,p),v));let m=v-p+1;t.fillRect(p,f,m,u-f),t.fillRect(p,c+1,m,d-c),n=v}}qn(t){let i=Math.floor(1*t);this.bn<=2*i&&(i=Math.floor(.5*(this.bn-1)));let s=Math.max(Math.floor(t),i);return this.bn<=2*s?Math.max(Math.floor(t),Math.floor(1*t)):s}Un(t,i,s,e,h){if(null===this.Nt)return;let l="",r=this.qn(h),n=null;for(let o=s.from;o<s.to;o++){let a=i[o];a.Dt!==l&&(t.fillStyle=a.Dt,l=a.Dt);let u=Math.round(a.tt*h)-Math.floor(.5*this.bn),c=u+this.bn-1,f=Math.round(Math.min(a.Cn,a.Tn)*h),d=Math.round(Math.max(a.Cn,a.Tn)*h);if(null!==n&&(u=Math.min(u=Math.max(n+1,u),c)),this.Nt.wn*h>2*r){var p,v,m;p=u,v=c-u+1,m=d-f+1,t.fillRect(p+r,f,v-2*r,r),t.fillRect(p+r,f+m-r,v-2*r,r),t.fillRect(p,f,r,m),t.fillRect(p+v-r,f,r,m)}else{let g=c-u+1;t.fillRect(u,f,g,d-f+1)}n=c}}Yn(t,i,s,e){if(null===this.Nt)return;let h="",l=this.qn(e);for(let r=s.from;r<s.to;r++){let n=i[r],o=Math.round(Math.min(n.Cn,n.Tn)*e),a=Math.round(Math.max(n.Cn,n.Tn)*e),u=Math.round(n.tt*e)-Math.floor(.5*this.bn),c=u+this.bn-1;if(n.O!==h){let f=n.O;t.fillStyle=f,h=f}this.Nt.Hn&&(u+=l,o+=l,c-=l,a-=l),o>a||t.fillRect(u,o,c-u+1,a-o+1)}}constructor(){this.Nt=null,this.bn=0}}class tH extends tA{vt(t,i){if(!this.Gs.St())return null;let s=this.Gs.V();this.tn();let e={_s:this.Ks,wn:this.Js.gt().wn(),jn:s.wickVisible,Hn:s.borderVisible,G:this.Zs};return this.Ft.Z(e),this.Ft}en(){this.Ks.forEach(t=>{let i=this.Gs.cn().In(t.rt);t.O=i.En,t.Xn=i.Kn,t.Dt=i.Zn})}fn(t,i,s){let e=s.In(t);return Object.assign(Object.assign({},this.Pn(t,i,s)),{O:e.En,Xn:e.Kn,Dt:e.Zn})}constructor(){super(...arguments),this.Ft=new tZ}}class tY{Z(t){this.Nt=t,this.Gn=[]}U(t,i,s,e){if(null===this.Nt||0===this.Nt.J.length||null===this.Nt.G)return;this.Gn.length||this.Jn(i);let h=Math.max(1,Math.floor(i)),l=Math.round(this.Nt.Qn*i)-Math.floor(h/2),r=l+h;for(let n=this.Nt.G.from;n<this.Nt.G.to;n++){let o,a;let u=this.Nt.J[n],c=this.Gn[n-this.Nt.G.from],f=Math.round(u.it*i);t.fillStyle=u.O,f<=l?(o=f,a=r):(o=l,a=f-Math.floor(h/2)+h),t.fillRect(c.Hs,o,c.Us-c.Hs+1,a-o)}}Jn(t){if(null===this.Nt||0===this.Nt.J.length||null===this.Nt.G)return void(this.Gn=[]);let i=1>=Math.ceil(this.Nt.wn*t)?0:Math.max(1,Math.floor(t)),s=Math.round(this.Nt.wn*t)-i;this.Gn=Array(this.Nt.G.to-this.Nt.G.from);for(let e=this.Nt.G.from;e<this.Nt.G.to;e++){let h,l;let r=this.Nt.J[e],n=Math.round(r.tt*t);if(s%2){let o=(s-1)/2;h=n-o,l=n+o}else{let a=s/2;h=n-a,l=n+a-1}this.Gn[e-this.Nt.G.from]={Hs:h,Us:l,te:n,ie:r.tt*t,rt:r.rt}}for(let u=this.Nt.G.from+1;u<this.Nt.G.to;u++){let c=this.Gn[u-this.Nt.G.from],f=this.Gn[u-this.Nt.G.from-1];c.rt===f.rt+1&&c.Hs-f.Us!==i+1&&(f.te>f.ie?f.Us=c.Hs-i-1:c.Hs=f.Us+i+1)}let d=Math.ceil(this.Nt.wn*t);for(let p=this.Nt.G.from;p<this.Nt.G.to;p++){let v=this.Gn[p-this.Nt.G.from];v.Us<v.Hs&&(v.Us=v.Hs);let m=v.Us-v.Hs+1;d=Math.min(m,d)}if(i>0&&d<4)for(let g=this.Nt.G.from;g<this.Nt.G.to;g++){let b=this.Gn[g-this.Nt.G.from];b.Us-b.Hs+1>d&&(b.te>b.ie?b.Us-=1:b.Hs+=1)}}constructor(){this.Nt=null,this.Gn=[]}}function t$(t){return{J:[],wn:t,Qn:NaN,G:null}}class tQ extends tP{vt(t,i){return this.Gs.St()?(this.tn(),this.lt):null}sn(){let t=this.Js.gt().wn();this.se=t$(t);let i=0,s=0,e=this.Gs.V().color;for(let h of this.Gs._s().dn()){let l=h.Tt[3],r=void 0!==h.O?h.O:e,n={rt:h.pn,ht:l,tt:NaN,it:NaN,O:r};++i<this.se.J.length?this.se.J[i]=n:this.se.J.push(n),this.Ks[s++]={rt:h.pn,tt:0}}this.Ft.Z(this.se),this.lt.H([this.Ft])}en(){}rn(){super.rn(),this.se.G=null}an(t,i,s){if(null===this.Zs)return;let e=i.wn(),h=T(i.hn()),l=t.xt(this.Gs.V().base,s);i.on(this.se.J),t._n(this.se.J,s),this.se.Qn=l,this.se.G=tR(this.se.J,h,!1),this.se.wn=e,this.Ft.Z(this.se)}constructor(t,i){super(t,i,!1),this.lt=new $,this.se=t$(0),this.Ft=new tY}}class tX extends tL{vt(t,i){if(!this.Gs.St())return null;let s=this.Gs.V();this.tn();let e={J:this.Ks,et:s.color,Bt:s.lineStyle,Bs:s.lineType,Lt:s.lineWidth,G:this.Zs,Is:this.Js.gt().wn()};return this.mn.Z(e),this.mn}en(){this.Ks.forEach(t=>{t.O=this.Gs.cn().In(t.rt).En})}fn(t,i,s){let e=this.un(t,i);return e.O=s.In(t).En,e}constructor(t,i){super(t,i),this.mn=new tk}}let t0=/[2-9]/g;class t1{he(){this.ne.clear(),this.re.fill(void 0)}Qt(t,i,s){let e=String(i).replace(s||t0,"0"),h=this.ne.get(e);if(void 0===h){if(0===(h=t.measureText(e).width)&&0!==i.length)return 0;let l=this.re[this.ee];void 0!==l&&this.ne.delete(l),this.re[this.ee]=e,this.ee=(this.ee+1)%this.re.length,this.ne.set(e,h)}return h}constructor(t=50){this.ne=new Map,this.ee=0,this.re=Array.from(Array(t))}}class t2{ue(t,i,s,e){this.le=t,this.S=i,this.oe=s,this.ae=e}U(t,i){null!==this.S&&null!==this.le&&this.le.U(t,this.S,this._e,this.oe,this.ae,i)}constructor(t){this.le=null,this.S=null,this.ae="right",this.oe=0,this._e=t}}class t3{vt(t,i){let s=this.B.fe(this.de);if(null===s)return null;let e=s.pe(this.de)?s.ve():this.de.Ct();if(null===e)return null;let h=s.me(e);if("overlay"===h)return null;let l=this.B.we();return l.T!==this.F&&(this.F=l.T,this._e.he()),this.Ft.ue(this.ce.ci(),l,i,h),this.Ft}constructor(t,i,s){this.ce=t,this._e=new t1(50),this.de=i,this.B=s,this.F=-1,this.Ft=new t2(this._e)}}class t5{Z(t){this.Nt=t}U(t,i,s,e){if(null===this.Nt||!1===this.Nt.St)return;let h=Math.round(this.Nt.it*i);if(h<0||h>Math.ceil(this.Nt.qt*i))return;let l=Math.ceil(this.Nt.Ut*i);t.lineCap="butt",t.strokeStyle=this.Nt.O,t.lineWidth=Math.floor(this.Nt.Lt*i),S(t,this.Nt.Bt),x(t,h,0,l)}constructor(){this.Nt=null}}class t6{dt(){this.ut=!0}vt(t,i){return this.Gs.St()?(this.ut&&(this.Me(t,i),this.ut=!1),this.ge):null}constructor(t){this.be={Ut:0,qt:0,it:0,O:"rgba(0, 0, 0, 0)",Lt:1,Bt:0,St:!1},this.ge=new t5,this.ut=!0,this.Gs=t,this.Js=t.jt(),this.ge.Z(this.be)}}class t4 extends t6{Me(t,i){this.be.St=!1;let s=this.Gs.Ct(),e=s.Se().Se;if(2!==e&&3!==e)return;let h=this.Gs.V();if(!h.baseLineVisible||!this.Gs.St())return;let l=this.Gs.yt();null!==l&&(this.be.St=!0,this.be.it=s.xt(l.Tt,l.Tt),this.be.Ut=i,this.be.qt=t,this.be.O=h.baseLineColor,this.be.Lt=h.baseLineWidth,this.be.Bt=h.baseLineStyle)}constructor(t){super(t)}}class t8{Z(t){this.Nt=t}ye(){return this.Nt}U(t,i,s,e){let h=this.Nt;if(null===h)return;t.save();let l=Math.max(1,Math.floor(i)),r=Math.round(h.ie.x*i)+l%2/2,n=h.ie.y*i;t.fillStyle=h.ke,t.beginPath();let o=Math.max(2,1.5*h.xe)*i;t.arc(r,n,o,0,2*Math.PI,!1),t.fill(),t.fillStyle=h.Ce,t.beginPath(),t.arc(r,n,h.nt*i,0,2*Math.PI,!1),t.fill(),t.lineWidth=l,t.strokeStyle=h.Te,t.beginPath(),t.arc(r,n,h.nt*i+l/2,0,2*Math.PI,!1),t.stroke(),t.restore()}constructor(){this.Nt=null}}let t9=[{De:0,Pe:.25,Oe:4,Ne:10,Re:.25,Ae:0,Ee:.4,Ie:.8},{De:.25,Pe:.525,Oe:10,Ne:14,Re:0,Ae:0,Ee:.8,Ie:0},{De:.525,Pe:1,Oe:14,Ne:14,Re:0,Ae:0,Ee:0,Ie:0}];function t7(t,i,s,e){return function(t,i){if("transparent"===t)return t;let s=G(t),e=s[3];return"rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", ").concat(i*e,")")}(t,s+(e-s)*i)}function it(t,i){var s;let e;let h=t%2600/2600;for(let l of t9)if(h>=l.De&&h<=l.Pe){e=l;break}_(void 0!==e,"Last price animation internal logic error");let r=(h-e.De)/(e.Pe-e.De);return{Ce:t7(i,r,e.Re,e.Ae),Te:t7(i,r,e.Ee,e.Ie),nt:(s=e.Oe)+(e.Ne-s)*r}}class ii{ze(){this.Ve=this.Be-1,this.dt()}We(){if(this.dt(),2===this.Fe.V().lastPriceAnimation){let t=performance.now(),i=this.Ve-t;if(i>0)return void(i<650&&(this.Ve+=2600));this.Be=t,this.Ve=t+2600}}dt(){this.ut=!0}je(){this.Le=!0}St(){return 0!==this.Fe.V().lastPriceAnimation}$e(){switch(this.Fe.V().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Ve}}vt(t,i){return this.ut?(this.wt(t,i),this.ut=!1,this.Le=!1):this.Le&&(this.He(),this.Le=!1),this.Ft}wt(t,i){this.Ft.Z(null);let s=this.Fe.jt().gt(),e=s.hn(),h=this.Fe.yt();if(null===e||null===h)return;let l=this.Fe.Ue(!0);if(l.qe||!e.Ye(l.pn))return;let r={x:s.Ot(l.pn),y:this.Fe.Ct().xt(l.ht,h.Tt)},n=l.O,o=this.Fe.V().lineWidth,a=it(this.Xe(),n);this.Ft.Z({ke:n,xe:o,Ce:a.Ce,Te:a.Te,nt:a.nt,ie:r})}He(){let t=this.Ft.ye();if(null!==t){let i=it(this.Xe(),t.ke);t.Ce=i.Ce,t.Te=i.Te,t.nt=i.nt}}Xe(){return this.$e()?performance.now()-this.Be:2599}constructor(t){this.Ft=new t8,this.ut=!0,this.Le=!0,this.Be=performance.now(),this.Ve=this.Be-1,this.Fe=t}}function is(t,i){return tz(Math.min(Math.max(t,12),30)*i)}function ie(t,i){switch(t){case"arrowDown":case"arrowUp":return is(i,1);case"circle":return is(i,.8);case"square":return is(i,.7)}}function ih(t){return Math.max(is(t,.1),3)}function il(t,i,s,e,h){let l=ie("square",s),r=(l-1)/2,n=t-r,o=i-r;return e>=n&&e<=n+l&&h>=o&&h<=o+l}function ir(t,i,s,e,h){let l=(ie("arrowUp",h)-1)/2,r=(tz(h/2)-1)/2;i.beginPath(),t?(i.moveTo(s-l,e),i.lineTo(s,e-l),i.lineTo(s+l,e),i.lineTo(s+r,e),i.lineTo(s+r,e+l),i.lineTo(s-r,e+l),i.lineTo(s-r,e)):(i.moveTo(s-l,e),i.lineTo(s,e+l),i.lineTo(s+l,e),i.lineTo(s+r,e),i.lineTo(s+r,e-l),i.lineTo(s-r,e-l),i.lineTo(s-r,e)),i.fill()}class io extends Q{Z(t){this.Nt=t}ue(t,i){this.F===t&&this.W===i||(this.F=t,this.W=i,this.Ke=H(t,i),this._e.he())}Ze(t,i){if(null===this.Nt||null===this.Nt.G)return null;for(let s=this.Nt.G.from;s<this.Nt.G.to;s++){let e=this.Nt.J[s];if(!(void 0===e.Jt||!function(t,i,s,e,h,l){let r=e/2;return h>=t&&h<=t+s&&l>=i-r&&l<=i+r}(e.tt,e.Jt.it,e.Jt.Ut,e.Jt.qt,t,i))||function(t,i,s){if(0===t.ln)return!1;switch(t.ir){case"arrowDown":case"arrowUp":var e;return e=t.tt,il(e,t.it,t.ln,i,s);case"circle":return function(t,i,s,e,h){let l=2+ie("circle",s)/2,r=t-e,n=i-h;return Math.sqrt(r*r+n*n)<=l}(t.tt,t.it,t.ln,i,s);case"square":return il(t.tt,t.it,t.ln,i,s)}}(e,t,i))return{Ge:e.Je,Qe:e.Qe}}return null}q(t,i,s){if(null!==this.Nt&&null!==this.Nt.G){t.textBaseline="middle",t.font=this.Ke;for(let e=this.Nt.G.from;e<this.Nt.G.to;e++){let h=this.Nt.J[e];void 0!==h.Jt&&(h.Jt.Ut=this._e.Qt(t,h.Jt.tr),h.Jt.qt=this.F),t.fillStyle=h.O,void 0!==h.Jt&&function(t,i,s,e){t.fillText(i,s,e)}(t,h.Jt.tr,h.tt-h.Jt.Ut/2,h.Jt.it),function(t,i){if(0!==t.ln){switch(t.ir){case"arrowDown":return void ir(!1,i,t.tt,t.it,t.ln);case"arrowUp":return void ir(!0,i,t.tt,t.it,t.ln);case"circle":return void function(t,i,s,e){let h=(ie("circle",e)-1)/2;t.beginPath(),t.arc(i,s,h,0,2*Math.PI,!1),t.fill()}(i,t.tt,t.it,t.ln);case"square":return void function(t,i,s,e){let h=ie("square",e),l=(h-1)/2;t.fillRect(i-l,s-l,h,h)}(i,t.tt,t.it,t.ln)}t.ir}}(h,t)}}}constructor(){super(...arguments),this.Nt=null,this._e=new t1,this.F=-1,this.W="",this.Ke=""}}class ia{dt(t){this.ut=!0,this.rr=!0,"data"===t&&(this.er=!0)}vt(t,i,s){if(!this.Fe.St())return null;this.ut&&this.tn();let e=this.gi.V().layout;return this.Ft.ue(e.fontSize,e.fontFamily),this.Ft.Z(this.Nt),this.Ft}lr(){if(this.rr){if(this.Fe.ar().length>0){let t=this.gi.gt().wn(),i=ih(t),s=1.5*tJ(is(t,1))+2*i;this.hr={above:s,below:s}}else this.hr=null;this.rr=!1}return this.hr}tn(){let t=this.Fe.Ct(),i=this.gi.gt(),s=this.Fe.ar();this.er&&(this.Nt.J=s.map(t=>({rt:t.time,tt:0,it:0,ln:0,ir:t.shape,O:t.color,Je:t.internalId,Qe:t.id,Jt:void 0})),this.er=!1);let e=this.gi.V().layout;this.Nt.G=null;let h=i.hn();if(null===h)return;let l=this.Fe.yt();if(null===l||0===this.Nt.J.length)return;let r=NaN,n=ih(i.wn()),o={sr:n,nr:n};this.Nt.G=tR(this.Nt.J,h,!0);for(let a=this.Nt.G.from;a<this.Nt.G.to;a++){let u=s[a];u.time!==r&&(o.sr=n,o.nr=n,r=u.time);let c=this.Nt.J[a];c.tt=i.Ot(u.time),void 0!==u.text&&u.text.length>0&&(c.Jt={tr:u.text,it:0,Ut:0,qt:0});let f=this.Fe._r(u.time);null!==f&&function(t,i,s,e,h,l,r,n,o){let a=U(s)?s:s.An,u=U(s)?s:s.Nn,c=U(s)?s:s.Rn,f=U(i.size)?Math.max(i.size,0):1,d=tJ(is(n.wn(),1))*f,p=d/2;switch(t.ln=d,i.position){case"inBar":return t.it=r.xt(a,o),void(void 0!==t.Jt&&(t.Jt.it=t.it+p+l+.6*h));case"aboveBar":return t.it=r.xt(u,o)-p-e.sr,void 0!==t.Jt&&(t.Jt.it=t.it-p-.6*h,e.sr+=1.2*h),void(e.sr+=d+l);case"belowBar":return t.it=r.xt(c,o)+p+e.nr,void 0!==t.Jt&&(t.Jt.it=t.it+p+l+.6*h,e.nr+=1.2*h),void(e.nr+=d+l)}i.position}(c,u,f,o,e.fontSize,n,t,i,l.Tt)}this.ut=!1}constructor(t,i){this.ut=!0,this.er=!0,this.rr=!0,this.hr=null,this.Ft=new io,this.Fe=t,this.gi=i,this.Nt={J:[],G:null}}}class iu extends t6{Me(t,i){let s=this.be;s.St=!1;let e=this.Gs.V();if(!e.priceLineVisible||!this.Gs.St())return;let h=this.Gs.Ue(0===e.priceLineSource);h.qe||(s.St=!0,s.it=h.ti,s.O=this.Gs.ur(h.O),s.Ut=i,s.qt=t,s.Lt=e.priceLineWidth,s.Bt=e.priceLineStyle)}constructor(t){super(t)}}class ic extends ta{di(t,i,s){t.St=!1,i.St=!1;let e=this.zt;if(!e.St())return;let h=e.V(),l=h.lastValueVisible,r=""!==e.cr(),n=0===h.seriesLastValueMode,o=e.Ue(!1);if(o.qe)return;l&&(t.Jt=this.dr(o,l,n),t.St=0!==t.Jt.length),(r||n)&&(i.Jt=this.pr(o,l,r,n),i.St=i.Jt.length>0);let a=e.ur(o.O),u=j(a);s.t=u.t,s.O=u.i,s.ti=o.ti,i.Dt=e.jt().Pt(o.ti/e.Ct().qt()),t.Dt=a}pr(t,i,s,e){let h="",l=this.zt.cr();return s&&0!==l.length&&(h+="".concat(l," ")),i&&e&&(h+=this.zt.Ct().vr()?t.mr:t.wr),h.trim()}dr(t,i,s){return i?s?this.zt.Ct().vr()?t.wr:t.mr:t.Jt:""}constructor(t){super(),this.zt=t}}class id{Mr(t){return null!==t&&this.br===t.br&&this.gr===t.gr}Sr(){return new id(this.br,this.gr)}yr(){return this.br}kr(){return this.gr}Cr(){return this.gr-this.br}vi(){return this.gr===this.br||Number.isNaN(this.gr)||Number.isNaN(this.br)}Ts(t){return null===t?this:new id(Math.min(this.yr(),t.yr()),Math.max(this.kr(),t.kr()))}Tr(t){if(!U(t)||0==this.gr-this.br)return;let i=.5*(this.gr+this.br),s=this.gr-i,e=this.br-i;s*=t,e*=t,this.gr=i+s,this.br=i+e}Dr(t){U(t)&&(this.gr+=t,this.br+=t)}Pr(){return{minValue:this.br,maxValue:this.gr}}static Or(t){return null===t?null:new id(t.minValue,t.maxValue)}constructor(t,i){this.br=t,this.gr=i}}class ip{Ar(){return this.Nr}Er(){return this.Rr}Pr(){return null===this.Nr?null:{priceRange:this.Nr.Pr(),margins:this.Rr||void 0}}static Or(t){return null===t?null:new ip(id.Or(t.priceRange),t.margins)}constructor(t,i){this.Nr=t,this.Rr=i||null}}class iv extends t6{Me(t,i){let s=this.be;s.St=!1;let e=this.Ir.V();if(!this.Gs.St()||!e.lineVisible)return;let h=this.Ir.Lr();null!==h&&(s.St=!0,s.it=h,s.O=e.color,s.Ut=i,s.qt=t,s.Lt=e.lineWidth,s.Bt=e.lineStyle)}constructor(t,i){super(t),this.Ir=i}}class im extends ta{di(t,i,s){t.St=!1,i.St=!1;let e=this.Ir.V(),h=e.axisLabelVisible,l=""!==e.title,r=this.Fe;if(!h||!r.St())return;let n=this.Ir.Lr();if(null===n)return;l&&(i.Jt=e.title,i.St=!0),i.Dt=r.jt().Pt(n/r.Ct().qt()),t.Jt=this.Br(e.price),t.St=!0;let o=j(e.color);s.t=o.t,s.O=o.i,s.ti=n}Br(t){let i=this.Fe.yt();return null===i?"":this.Fe.Ct().mi(t,i.Tt)}constructor(t,i){super(),this.Fe=t,this.Ir=i}}class ig{zr(t){D(this.Fi,t),this.dt(),this.Fe.jt().Wr()}V(){return this.Fi}ss(){return[this.Vr,this.Fr]}jr(){return this.ce}dt(){this.Vr.dt(),this.ce.dt()}Lr(){let t=this.Fe,i=t.Ct();if(t.jt().gt().vi()||i.vi())return null;let s=t.yt();return null===s?null:i.xt(this.Fi.price,s.Tt)}constructor(t,i){this.Fe=t,this.Fi=i,this.Vr=new iv(t,this),this.ce=new im(t,this),this.Fr=new t3(this.ce,t,t.jt())}}class ib extends tp{jt(){return this.gi}constructor(t){super(),this.gi=t}}let iM={En:"",Zn:"",Kn:""};class iw{In(t,i){let s=this.Fe.$r(),e=this.Fe.V();switch(s){case"Line":return this.Hr(e,t,i);case"Area":return this.Ur(e);case"Baseline":return this.qr(e,t,i);case"Bar":return this.Yr(e,t,i);case"Candlestick":return this.Xr(e,t,i);case"Histogram":return this.Kr(e,t,i)}throw Error("Unknown chart style")}Yr(t,i,s){let e=Object.assign({},iM),h=t.upColor,l=t.downColor,r=T(this.Zr(i,s)),n=k(r.Tt[0])<=k(r.Tt[3]);return void 0!==r.O?(e.En=r.O,e.Zn=r.O):(e.En=n?h:l,e.Zn=n?h:l),e}Xr(t,i,s){var e,h,l;let r=Object.assign({},iM),n=t.upColor,o=t.downColor,a=t.borderUpColor,u=t.borderDownColor,c=t.wickUpColor,f=t.wickDownColor,d=T(this.Zr(i,s)),p=k(d.Tt[0])<=k(d.Tt[3]);return r.En=null!==(e=d.O)&&void 0!==e?e:p?n:o,r.Zn=null!==(h=d.Dt)&&void 0!==h?h:p?a:u,r.Kn=null!==(l=d.Xn)&&void 0!==l?l:p?c:f,r}Ur(t){return Object.assign(Object.assign({},iM),{En:t.lineColor})}qr(t,i,s){let e=T(this.Zr(i,s)).Tt[3]>=t.baseValue.price;return Object.assign(Object.assign({},iM),{En:e?t.topLineColor:t.bottomLineColor})}Hr(t,i,s){var e;let h=T(this.Zr(i,s));return Object.assign(Object.assign({},iM),{En:null!==(e=h.O)&&void 0!==e?e:t.color})}Kr(t,i,s){let e=Object.assign({},iM),h=T(this.Zr(i,s));return e.En=void 0!==h.O?h.O:t.color,e}Zr(t,i){return void 0!==i?i.Tt:this.Fe._s().Gr(t)}constructor(t){this.Fe=t}}(r=m||(m={}))[r.NearestLeft=-1]="NearestLeft",r[r.None=0]="None",r[r.NearestRight=1]="NearestRight";class iN{ih(){return this.ln()>0?this.Jr[this.Jr.length-1]:null}sh(){return this.ln()>0?this.nh(0):null}os(){return this.ln()>0?this.nh(this.Jr.length-1):null}ln(){return this.Jr.length}vi(){return 0===this.ln()}Ye(t){return null!==this.eh(t,0)}Gr(t){return this.rh(t)}rh(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=this.eh(t,i);return null===s?null:Object.assign(Object.assign({},this.hh(s)),{pn:this.nh(s)})}dn(){return this.Jr}lh(t,i,s){if(this.vi())return null;let e=null;for(let h of s)e=iy(e,this.ah(t,i,h));return e}Z(t){this.th.clear(),this.Qr.clear(),this.Jr=t}nh(t){return this.Jr[t].pn}hh(t){return this.Jr[t]}eh(t,i){let s=this.oh(t);if(null===s&&0!==i)switch(i){case -1:return this._h(t);case 1:return this.uh(t);default:throw TypeError("Unknown search mode")}return s}_h(t){let i=this.dh(t);return i>0&&(i-=1),i!==this.Jr.length&&this.nh(i)<t?i:null}uh(t){let i=this.fh(t);return i!==this.Jr.length&&t<this.nh(i)?i:null}oh(t){let i=this.dh(t);return i===this.Jr.length||t<this.Jr[i].pn?null:i}dh(t){return tE(this.Jr,t,(t,i)=>t.pn<i)}fh(t){return tI(this.Jr,t,(t,i)=>i.pn>t)}ph(t,i,s){let e=null;for(let h=t;h<i;h++){let l=this.Jr[h].Tt[s];Number.isNaN(l)||(null===e?e={mh:l,wh:l}:(l<e.mh&&(e.mh=l),l>e.wh&&(e.wh=l)))}return e}ah(t,i,s){if(this.vi())return null;let e=null,h=T(this.sh()),l=T(this.os()),r=Math.max(t,h),n=Math.min(i,l),o=30*Math.ceil(r/30),a=Math.max(o,30*Math.floor(n/30));{let u=this.dh(r),c=this.fh(Math.min(n,o,i));e=iy(e,this.ph(u,c,s))}let f=this.Qr.get(s);void 0===f&&(f=new Map,this.Qr.set(s,f));for(let d=Math.max(o+1,r);d<a;d+=30){let p=Math.floor(d/30),v=f.get(p);if(void 0===v){let m=this.dh(30*p),g=this.fh(30*(p+1)-1);v=this.ph(m,g,s),f.set(p,v)}e=iy(e,v)}{let b=this.dh(a),M=this.fh(n);e=iy(e,this.ph(b,M,s))}return e}constructor(){this.Jr=[],this.Qr=new Map,this.th=new Map}}function iy(t,i){return null===t?i:null===i?t:{mh:Math.min(t.mh,i.mh),wh:Math.max(t.wh,i.wh)}}class iC extends ib{M(){null!==this.xh&&clearTimeout(this.xh)}ur(t){return this.Fi.priceLineColor||t}Ue(t){let i,s;let e={qe:!0},h=this.Ct();if(this.jt().gt().vi()||h.vi()||this.Nt.vi())return e;let l=this.jt().gt().hn(),r=this.yt();if(null===l||null===r)return e;if(t){let n=this.Nt.ih();if(null===n)return e;i=n,s=n.pn}else{let o=this.Nt.rh(l.Us(),-1);if(null===o||null===(i=this.Nt.Gr(o.pn)))return e;s=o.pn}let a=i.Tt[3],u=this.cn().In(s,{Tt:i}),c=h.xt(a,r.Tt);return{qe:!1,ht:a,Jt:h.mi(a,r.Tt),mr:h.Ph(a),wr:h.Oh(a,r.Tt),O:u.En,ti:c,pn:s}}cn(){return null!==this.Sh||(this.Sh=new iw(this)),this.Sh}V(){return this.Fi}zr(t){let i=t.priceScaleId;void 0!==i&&i!==this.Fi.priceScaleId&&this.jt().Nh(this,i),D(this.Fi,t),void 0!==t.priceFormat&&(this.Th(),this.jt().Rh()),this.jt().Ah(this),this.jt().Eh(),this.qi.dt("options")}Z(t,i){this.Nt.Z(t),this.Ih(),this.qi.dt("data"),this.zi.dt("data"),null!==this.Mh&&(i&&i.Lh?this.Mh.We():0===t.length&&this.Mh.ze());let s=this.jt().fe(this);this.jt().Bh(s),this.jt().Ah(this),this.jt().Eh(),this.jt().Wr()}Vh(t){this.yh=t,this.Ih();let i=this.jt().fe(this);this.zi.dt("data"),this.jt().Bh(i),this.jt().Ah(this),this.jt().Eh(),this.jt().Wr()}Fh(){return this.yh}ar(){return this.kh}zh(t){let i=new ig(this,t);return this.bh.push(i),this.jt().Ah(this),i}Wh(t){let i=this.bh.indexOf(t);-1!==i&&this.bh.splice(i,1),this.jt().Ah(this)}$r(){return this.Ch}yt(){let t=this.jh();return null===t?null:{Tt:t.Tt[3],$h:t.rt}}jh(){let t=this.jt().gt().hn();if(null===t)return null;let i=t.Hs();return this.Nt.rh(i,1)}_s(){return this.Nt}_r(t){let i=this.Nt.Gr(t);return null===i?null:"Bar"===this.Ch||"Candlestick"===this.Ch?{On:i.Tt[0],Nn:i.Tt[1],Rn:i.Tt[2],An:i.Tt[3]}:i.Tt[3]}Hh(t){let i=this.Mh;return null!==i&&i.St()?(null===this.xh&&i.$e()&&(this.xh=setTimeout(()=>{this.xh=null,this.jt().Uh()},0)),i.je(),[i]):[]}ss(){let t=[];for(let i of(this.qh()||t.push(this.gh),t.push(this.qi,this.Vr,this.Fr,this.zi),this.bh))t.push(...i.ss());return t}ns(t,i){if(i!==this.yi&&!this.qh())return[];let s=[...this.Ai];for(let e of this.bh)s.push(e.jr());return s}Yh(t,i){if(void 0!==this.Fi.autoscaleInfoProvider){let s=this.Fi.autoscaleInfoProvider(()=>{let s=this.Xh(t,i);return null===s?null:s.Pr()});return ip.Or(s)}return this.Xh(t,i)}Kh(){return this.Fi.priceFormat.minMove}Zh(){return this.Gh}rs(){var t;for(let i of(this.qi.dt(),this.zi.dt(),this.Ai))i.dt();for(let s of this.bh)s.dt();this.Vr.dt(),this.gh.dt(),null===(t=this.Mh)||void 0===t||t.dt()}Ct(){return T(super.Ct())}Mt(t){if(!(("Line"===this.Ch||"Area"===this.Ch||"Baseline"===this.Ch)&&this.Fi.crosshairMarkerVisible))return null;let i=this.Nt.Gr(t);return null===i?null:{ht:i.Tt[3],nt:this.Jh(),Dt:this.Qh(),kt:this.tl(t)}}cr(){return this.Fi.title}St(){return this.Fi.visible}qh(){return!tm(this.Ct().il())}Xh(t,i){if(!B(t)||!B(i)||this.Nt.vi())return null;let s="Line"===this.Ch||"Area"===this.Ch||"Baseline"===this.Ch||"Histogram"===this.Ch?[3]:[2,1],e=this.Nt.lh(t,i,s),h=null!==e?new id(e.mh,e.wh):null;if("Histogram"===this.$r()){let l=this.Fi.base,r=new id(l,l);h=null!==h?h.Ts(r):r}return new ip(h,this.zi.lr())}Jh(){switch(this.Ch){case"Line":case"Area":case"Baseline":return this.Fi.crosshairMarkerRadius}return 0}Qh(){switch(this.Ch){case"Line":case"Area":case"Baseline":{let t=this.Fi.crosshairMarkerBorderColor;if(0!==t.length)return t}}return null}tl(t){switch(this.Ch){case"Line":case"Area":case"Baseline":{let i=this.Fi.crosshairMarkerBackgroundColor;if(0!==i.length)return i}}return this.cn().In(t).En}Th(){switch(this.Fi.priceFormat.type){case"custom":this.Gh={format:this.Fi.priceFormat.formatter};break;case"volume":this.Gh=new tN(this.Fi.priceFormat.precision);break;case"percent":this.Gh=new tw(this.Fi.priceFormat.precision);break;default:{let t=Math.pow(10,this.Fi.priceFormat.precision);this.Gh=new tM(t,this.Fi.priceFormat.minMove*t)}}null!==this.yi&&this.yi.sl()}Ih(){let t=this.jt().gt();if(t.vi()||0===this.Nt.ln())return void(this.kh=[]);let i=T(this.Nt.sh());this.kh=this.yh.map((s,e)=>{let h=T(t.nl(s.time,!0));return{time:T(this.Nt.rh(h,h<i?1:-1)).pn,position:s.position,shape:s.shape,color:s.color,id:s.id,internalId:e,text:s.text,size:s.size}})}Dh(){switch(this.zi=new ia(this,this.jt()),this.Ch){case"Bar":this.qi=new tD(this,this.jt());break;case"Candlestick":this.qi=new tH(this,this.jt());break;case"Line":this.qi=new tX(this,this.jt());break;case"Area":this.qi=new tG(this,this.jt());break;case"Baseline":this.qi=new tq(this,this.jt());break;case"Histogram":this.qi=new tQ(this,this.jt());break;default:throw Error("Unknown chart style assigned: "+this.Ch)}}constructor(t,i,s){super(t),this.Nt=new iN,this.Vr=new iu(this),this.bh=[],this.gh=new t4(this),this.Mh=null,this.Sh=null,this.yh=[],this.kh=[],this.xh=null,this.Fi=i,this.Ch=s;let e=new ic(this);this.Ai=[e],this.Fr=new t3(e,this,t),"Area"!==s&&"Line"!==s&&"Baseline"!==s||(this.Mh=new ii(this)),this.Th(),this.Dh()}}class iS{el(t,i,s){if(0===this.Fi.mode)return t;let e=s.ji(),h=e.yt();if(null===h)return t;let l=e.xt(t,h),r=s.rl().filter(t=>t instanceof iC).reduce((t,e)=>{if(s.pe(e)||!e.St())return t;let h=e.Ct(),l=e._s();if(h.vi()||!l.Ye(i))return t;let r=l.Gr(i);if(null===r)return t;let n=k(e.yt());return t.concat([h.xt(r.Tt[3],n.Tt)])},[]);if(0===r.length)return t;r.sort((t,i)=>Math.abs(t-l)-Math.abs(i-l));let n=r[0];return e.$i(n,h)}constructor(t){this.Fi=t}}class ix{Z(t){this.Nt=t}U(t,i,s,e){if(null===this.Nt)return;let h=Math.max(1,Math.floor(i));t.lineWidth=h;let l=Math.ceil(this.Nt.It*i),r=Math.ceil(this.Nt.Et*i);t.save(),t.lineWidth%2&&t.translate(.5,.5),(()=>{let s=T(this.Nt);if(s.hl){for(let e of(t.strokeStyle=s.ll,S(t,s.al),t.beginPath(),s.ol)){let n=Math.round(e._l*i);t.moveTo(n,-h),t.lineTo(n,l+h)}t.stroke()}if(s.ul){for(let o of(t.strokeStyle=s.cl,S(t,s.dl),t.beginPath(),s.fl)){let a=Math.round(o._l*i);t.moveTo(-h,a),t.lineTo(r+h,a)}t.stroke()}})(),t.restore()}constructor(){this.Nt=null}}class i_{dt(){this.ut=!0}vt(t,i){if(this.ut){let s=this.Pi.jt().V().grid,e={It:t,Et:i,ul:s.horzLines.visible,hl:s.vertLines.visible,cl:s.horzLines.color,ll:s.vertLines.color,dl:s.horzLines.style,al:s.vertLines.style,fl:this.Pi.ji().pl(),ol:this.Pi.jt().gt().pl()||[]};this.Ft.Z(e),this.ut=!1}return this.Ft}constructor(t){this.Ft=new ix,this.ut=!0,this.Pi=t}}class iF{vl(){return this.qi}constructor(t){this.qi=new i_(t)}}let iT={ml:4,wl:1e-4};function ik(t,i){let s=100*(t-i)/i;return i<0?-s:s}function iE(t,i){let s=100*(t-i)/i+100;return i<0?-s:s}function iI(t,i){let s=Math.abs(t);if(s<1e-15)return 0;let e=tB(s+i.wl)+i.ml;return t<0?-e:e}function iO(t,i){let s=Math.abs(t);if(s<1e-15)return 0;let e=Math.pow(10,s-i.ml)-i.wl;return t<0?-e:e}function iV(t,i){if(null===t)return null;let s=iI(t.yr(),i),e=iI(t.kr(),i);return new id(s,e)}function iR(t,i){if(null===t)return null;let s=iO(t.yr(),i),e=iO(t.kr(),i);return new id(s,e)}function iP(t){if(null===t)return iT;let i=Math.abs(t.kr()-t.yr());if(i>=1||i<1e-15)return iT;let s=iT.ml+Math.ceil(Math.abs(Math.log10(i)));return{ml:s,wl:1/Math.pow(10,s)}}class iL{Sl(t,i,s){let e=0===this.bl?0:1/this.bl,h=Math.pow(10,Math.max(0,Math.ceil(tB(t-i)))),l=0,r=this.gl[0];for(;;){var n;let o=(n=h,e-n<=1e-14&&h>e+1e-14),a=s*r-h<=1e-14,u=1-h<=1e-14;if(!(o&&a&&u))break;h/=r,r=this.gl[++l%this.gl.length]}if(h<=e+1e-14&&(h=e),h=Math.max(1,h),this.Ml.length>0&&1e-14>Math.abs(h-1))for(l=0,r=this.Ml[0];s*r-h<=1e-14&&h>e+1e-14;)h/=r,r=this.Ml[++l%this.Ml.length];return h}constructor(t,i){if(this.bl=t,this.gl=i,function(t){if(t<0)return!1;for(let i=t;i>1;i/=10)if(i%10!=0)return!1;return!0}(this.bl))this.Ml=[2,2.5,2];else{this.Ml=[];for(let s=this.bl;1!==s;){if(s%2==0)this.Ml.push(2),s/=2;else{if(s%5!=0)throw Error("unexpected base");this.Ml.push(2,2.5),s/=5}if(this.Ml.length>100)throw Error("something wrong with base")}}}}class iG{Sl(t,i){if(t<i)throw Error("high < low");let s=this.fi.qt(),e=(t-i)*this.Cl()/s,h=new iL(this.bl,[2,2.5,2]),l=new iL(this.bl,[2,2,2.5]),r=new iL(this.bl,[2.5,2,2]),n=[];return n.push(h.Sl(t,i,e),l.Sl(t,i,e),r.Sl(t,i,e)),function(t){if(t.length<1)throw Error("array is empty");let i=t[0];for(let s=1;s<t.length;++s)t[s]<i&&(i=t[s]);return i}(n)}Tl(){let t=this.fi,i=t.yt();if(null===i)return void(this.yl=[]);let s=t.qt(),e=this.kl(s-1,i),h=this.kl(0,i),l=this.fi.V().entireTextOnly?this.Dl()/2:0,r=s-1-l,n=Math.max(e,h),o=Math.min(e,h);if(n===o)return void(this.yl=[]);let a=this.Sl(n,o),u=n%a;u+=u<0?a:0;let c=n>=o?1:-1,f=null,d=0;for(let p=n-u;p>o;p-=a){let v=this.xl(p,i,!0);null!==f&&Math.abs(v-f)<this.Cl()||v<l||v>r||(d<this.yl.length?(this.yl[d]._l=v,this.yl[d].Pl=t.Ol(p)):this.yl.push({_l:v,Pl:t.Ol(p)}),d++,f=v,t.Nl()&&(a=this.Sl(p*c,o)))}this.yl.length=d}pl(){return this.yl}Dl(){return this.fi.T()}Cl(){return Math.ceil(2.5*this.Dl())}constructor(t,i,s,e){this.yl=[],this.fi=t,this.bl=i,this.kl=s,this.xl=e}}function ij(t){return t.slice().sort((t,i)=>T(t.xi())-T(i.xi()))}(n=g||(g={}))[n.Normal=0]="Normal",n[n.Logarithmic=1]="Logarithmic",n[n.Percentage=2]="Percentage",n[n.IndexedTo100=3]="IndexedTo100";let iA=new tw,iD=new tM(100,1);class iU{il(){return this.Xl}V(){return this.Fi}zr(t){if(D(this.Fi,t),this.sl(),void 0!==t.mode&&this.ta({Se:t.mode}),void 0!==t.scaleMargins){let i=F(t.scaleMargins.top),s=F(t.scaleMargins.bottom);if(i<0||i>1)throw Error("Invalid top margin - expect value between 0 and 1, given=".concat(i));if(s<0||s>1||i+s>1)throw Error("Invalid bottom margin - expect value between 0 and 1, given=".concat(s));if(i+s>1)throw Error("Invalid margins - sum of margins must be less than 1, given=".concat(i+s));this.ia(),this.Hl=null}}sa(){return this.Fi.autoScale}Nl(){return 1===this.Fi.mode}vr(){return 2===this.Fi.mode}na(){return 3===this.Fi.mode}Se(){return{vs:this.Fi.autoScale,ea:this.Fi.invertScale,Se:this.Fi.mode}}ta(t){let i=this.Se(),s=null;void 0!==t.vs&&(this.Fi.autoScale=t.vs),void 0!==t.Se&&(this.Fi.mode=t.Se,2!==t.Se&&3!==t.Se||(this.Fi.autoScale=!0),this.Il.Ll=!1),1===i.Se&&t.Se!==i.Se&&(function(t,i){if(null===t)return!1;let s=iO(t.yr(),i),e=iO(t.kr(),i);return isFinite(s)&&isFinite(e)}(this.Nr,this.Yl)?null!==(s=iR(this.Nr,this.Yl))&&this.ra(s):this.Fi.autoScale=!0),1===t.Se&&t.Se!==i.Se&&null!==(s=iV(this.Nr,this.Yl))&&this.ra(s);let e=i.Se!==this.Fi.mode;e&&(2===i.Se||this.vr())&&this.sl(),e&&(3===i.Se||this.na())&&this.sl(),void 0!==t.ea&&i.ea!==t.ea&&(this.Fi.invertScale=t.ea,this.ha()),this.Wl.m(i,this.Se())}la(){return this.Wl}T(){return this.Kl.fontSize}qt(){return this.Rl}aa(t){this.Rl!==t&&(this.Rl=t,this.ia(),this.Hl=null)}oa(){if(this.Al)return this.Al;let t=this.qt()-this._a()-this.ua();return this.Al=t,t}Ar(){return this.ca(),this.Nr}ra(t,i){let s=this.Nr;(i||null===s&&null!==t||null!==s&&!s.Mr(t))&&(this.Hl=null,this.Nr=t)}vi(){return this.ca(),0===this.Rl||!this.Nr||this.Nr.vi()}da(t){return this.ea()?t:this.qt()-1-t}xt(t,i){return this.vr()?t=ik(t,i):this.na()&&(t=iE(t,i)),this.Ql(t,i)}_n(t,i,s){this.ca();let e=this.ua(),h=T(this.Ar()),l=h.yr(),r=h.kr(),n=this.oa()-1,o=this.ea(),a=n/(r-l),u=void 0===s?0:s.from,c=void 0===s?t.length:s.to,f=this.fa();for(let d=u;d<c;d++){let p=t[d],v=p.ht;if(isNaN(v))continue;let m=v;null!==f&&(m=f(p.ht,i));let g=e+a*(m-l),b=o?g:this.Rl-1-g;p.it=b}}Dn(t,i,s){this.ca();let e=this.ua(),h=T(this.Ar()),l=h.yr(),r=h.kr(),n=this.oa()-1,o=this.ea(),a=n/(r-l),u=void 0===s?0:s.from,c=void 0===s?t.length:s.to,f=this.fa();for(let d=u;d<c;d++){let p=t[d],v=p.On,m=p.Nn,g=p.Rn,b=p.An;null!==f&&(v=f(p.On,i),m=f(p.Nn,i),g=f(p.Rn,i),b=f(p.An,i));let M=e+a*(v-l),w=o?M:this.Rl-1-M;p.Cn=w,M=e+a*(m-l),w=o?M:this.Rl-1-M,p.yn=w,M=e+a*(g-l),w=o?M:this.Rl-1-M,p.kn=w,M=e+a*(b-l),w=o?M:this.Rl-1-M,p.Tn=w}}$i(t,i){let s=this.Jl(t,i);return this.pa(s,i)}pa(t,i){var s,e;let h=t;return this.vr()?(s=h,i<0&&(s=-s),h=s/100*i+i):this.na()&&(e=h-100,i<0&&(e=-e),h=e/100*i+i),h}rl(){return this.jl}va(){if(this.$l)return this.$l;let t=[];for(let i=0;i<this.jl.length;i++){let s=this.jl[i];null===s.xi()&&s.Ci(i+1),t.push(s)}return t=ij(t),this.$l=t,this.$l}ma(t){-1===this.jl.indexOf(t)&&(this.jl.push(t),this.sl(),this.wa())}ba(t){let i=this.jl.indexOf(t);if(-1===i)throw Error("source is not attached to scale");this.jl.splice(i,1),0===this.jl.length&&(this.ta({vs:!0}),this.ra(null)),this.sl(),this.wa()}yt(){let t=null;for(let i of this.jl){let s=i.yt();null!==s&&(null===t||s.$h<t.$h)&&(t=s)}return null===t?null:t.Tt}ea(){return this.Fi.invertScale}pl(){let t=null===this.yt();if(null!==this.Hl&&(t||this.Hl.ga===t))return this.Hl.pl;this.Gl.Tl();let i=this.Gl.pl();return this.Hl={pl:i,ga:t},this.zl.m(),i}Ma(){return this.zl}Sa(t){this.vr()||this.na()||null===this.Ul&&null===this.El&&(this.vi()||(this.Ul=this.Rl-t,this.El=T(this.Ar()).Sr()))}ya(t){if(this.vr()||this.na()||null===this.Ul)return;this.ta({vs:!1}),(t=this.Rl-t)<0&&(t=0);let i=(this.Ul+.2*(this.Rl-1))/(t+.2*(this.Rl-1)),s=T(this.El).Sr();i=Math.max(i,.1),s.Tr(i),this.ra(s)}ka(){this.vr()||this.na()||(this.Ul=null,this.El=null)}xa(t){this.sa()||null===this.ql&&null===this.El&&(this.vi()||(this.ql=t,this.El=T(this.Ar()).Sr()))}Ca(t){if(this.sa()||null===this.ql)return;let i=T(this.Ar()).Cr()/(this.oa()-1),s=t-this.ql;this.ea()&&(s*=-1);let e=s*i,h=T(this.El).Sr();h.Dr(e),this.ra(h,!0),this.Hl=null}Ta(){this.sa()||null!==this.ql&&(this.ql=null,this.El=null)}Zh(){return this.Gh||this.sl(),this.Gh}mi(t,i){switch(this.Fi.mode){case 2:return this.Zh().format(ik(t,i));case 3:return this.Zh().format(iE(t,i));default:return this.Br(t)}}Ol(t){switch(this.Fi.mode){case 2:case 3:return this.Zh().format(t);default:return this.Br(t)}}Ph(t){return this.Br(t,T(this.Da()).Zh())}Oh(t,i){return t=ik(t,i),iA.format(t)}Pa(){return this.jl}Oa(t){this.Il={Bl:t,Ll:!1}}rs(){this.jl.forEach(t=>t.rs())}sl(){this.Hl=null;let t=this.Da(),i=100;null!==t&&(i=Math.round(1/t.Kh())),this.Gh=iD,this.vr()?(this.Gh=iA,i=100):this.na()?(this.Gh=new tM(100,1),i=100):null!==t&&(this.Gh=t.Zh()),this.Gl=new iG(this,i,this.Jl.bind(this),this.Ql.bind(this)),this.Gl.Tl()}wa(){this.$l=null}Da(){return this.jl[0]||null}_a(){return this.ea()?this.Fi.scaleMargins.bottom*this.qt()+this.Fl:this.Fi.scaleMargins.top*this.qt()+this.Vl}ua(){return this.ea()?this.Fi.scaleMargins.top*this.qt()+this.Vl:this.Fi.scaleMargins.bottom*this.qt()+this.Fl}ca(){this.Il.Ll||(this.Il.Ll=!0,this.Na())}ia(){this.Al=null}Ql(t,i){if(this.ca(),this.vi())return 0;t=this.Nl()&&t?iI(t,this.Yl):t;let s=T(this.Ar()),e=this.ua()+(this.oa()-1)*(t-s.yr())/s.Cr();return this.da(e)}Jl(t,i){if(this.ca(),this.vi())return 0;let s=this.da(t),e=T(this.Ar()),h=e.yr()+e.Cr()*((s-this.ua())/(this.oa()-1));return this.Nl()?iO(h,this.Yl):h}ha(){this.Hl=null,this.Gl.Tl()}Na(){var t;let i=this.Il.Bl;if(null===i)return;let s=null,e=this.Pa(),h=0,l=0;for(let r of e){if(!r.St())continue;let n=r.yt();if(null===n)continue;let o=r.Yh(i.Hs(),i.Us()),a=o&&o.Ar();if(null!==a){switch(this.Fi.mode){case 1:a=iV(a,this.Yl);break;case 2:a=function(t,i){let s=ik(t.yr(),i),e=ik(t.kr(),i);return new id(s,e)}(a,n.Tt);break;case 3:a=function(t,i){let s=iE(t.yr(),i),e=iE(t.kr(),i);return new id(s,e)}(a,n.Tt)}if(s=null===s?a:s.Ts(T(a)),null!==o){let u=o.Er();null!==u&&(l=Math.max(h=Math.max(h,u.above),u.below))}}}if(h===this.Vl&&l===this.Fl||(this.Vl=h,this.Fl=l,this.Hl=null,this.ia()),null!==s){if(s.yr()===s.kr()){let c=this.Da(),f=5*(null===c||this.vr()||this.na()?1:c.Kh());this.Nl()&&(s=iR(s,this.Yl)),s=new id(s.yr()-f,s.kr()+f),this.Nl()&&(s=iV(s,this.Yl))}if(this.Nl()){let d=iR(s,this.Yl),p=iP(d);if(t=this.Yl,p.ml!==t.ml||p.wl!==t.wl){let v=null!==this.El?iR(this.El,this.Yl):null;this.Yl=p,s=iV(d,p),null!==v&&(this.El=iV(v,p))}}this.ra(s)}else null===this.Nr&&(this.ra(new id(-.5,.5)),this.Yl=iP(null));this.Il.Ll=!0}fa(){return this.vr()?ik:this.na()?iE:this.Nl()?t=>iI(t,this.Yl):null}Br(t,i){return void 0===this.Zl.priceFormatter?(void 0===i&&(i=this.Zh()),i.format(t)):this.Zl.priceFormatter(t)}constructor(t,i,s,e){this.Rl=0,this.Al=null,this.Nr=null,this.El=null,this.Il={Ll:!1,Bl:null},this.Vl=0,this.Fl=0,this.zl=new A,this.Wl=new A,this.jl=[],this.$l=null,this.Hl=null,this.Ul=null,this.ql=null,this.Gh=iD,this.Yl=iP(null),this.Xl=t,this.Fi=i,this.Kl=s,this.Zl=e,this.Gl=new iG(this,100,this.Jl.bind(this),this.Ql.bind(this))}}class iB{Wa(t){if(t.leftPriceScale&&this.Ba.zr(t.leftPriceScale),t.rightPriceScale&&this.Fa.zr(t.rightPriceScale),t.localization&&(this.Ba.sl(),this.Fa.sl()),t.overlayPriceScales){let i=Array.from(this.Ra.values());for(let s of i){let e=T(s[0].Ct());e.zr(t.overlayPriceScales),t.localization&&e.sl()}}}ja(t){switch(t){case"left":return this.Ba;case"right":return this.Fa}return this.Ra.has(t)?F(this.Ra.get(t))[0].Ct():null}M(){this.jt().$a().v(this),this.Ba.la().v(this),this.Fa.la().v(this),this.jl.forEach(t=>{t.M&&t.M()}),this.Ea.m()}Ha(){return this.Aa}Ua(t){this.Aa=t}jt(){return this.gi}Ut(){return this.oe}qt(){return this.Rl}qa(t){this.oe=t,this.Ya()}aa(t){this.Rl=t,this.Ba.aa(t),this.Fa.aa(t),this.jl.forEach(i=>{if(this.pe(i)){let s=i.Ct();null!==s&&s.aa(t)}}),this.Ya()}rl(){return this.jl}pe(t){let i=t.Ct();return null===i||this.Ba!==i&&this.Fa!==i}ma(t,i,s){let e=void 0!==s?s:this.Ka().Xa+1;this.Za(t,i,e)}ba(t){let i=this.jl.indexOf(t);_(-1!==i,"removeDataSource: invalid data source"),this.jl.splice(i,1);let s=T(t.Ct()).il();if(this.Ra.has(s)){let e=F(this.Ra.get(s)),h=e.indexOf(t);-1!==h&&(e.splice(h,1),0===e.length&&this.Ra.delete(s))}let l=t.Ct();l&&l.rl().indexOf(t)>=0&&l.ba(t),null!==l&&(l.wa(),this.Ga(l)),this.$l=null}me(t){return t===this.Ba?"left":t===this.Fa?"right":"overlay"}Ja(){return this.Ba}Qa(){return this.Fa}io(t,i){t.Sa(i)}so(t,i){t.ya(i),this.Ya()}no(t){t.ka()}eo(t,i){t.xa(i)}ro(t,i){t.Ca(i),this.Ya()}ho(t){t.Ta()}Ya(){this.jl.forEach(t=>{t.rs()})}ji(){let t=null;return this.gi.V().rightPriceScale.visible&&0!==this.Fa.rl().length?t=this.Fa:this.gi.V().leftPriceScale.visible&&0!==this.Ba.rl().length?t=this.Ba:0!==this.jl.length&&(t=this.jl[0].Ct()),null===t&&(t=this.Fa),t}ve(){let t=null;return this.gi.V().rightPriceScale.visible?t=this.Fa:this.gi.V().leftPriceScale.visible&&(t=this.Ba),t}Ga(t){null!==t&&t.sa()&&this.lo(t)}ao(t){let i=this.Ia.hn();t.ta({vs:!0}),null!==i&&t.Oa(i),this.Ya()}oo(){this.lo(this.Ba),this.lo(this.Fa)}_o(){this.Ga(this.Ba),this.Ga(this.Fa),this.jl.forEach(t=>{this.pe(t)&&this.Ga(t.Ct())}),this.Ya(),this.gi.Wr()}va(){return null===this.$l&&(this.$l=ij(this.jl)),this.$l}uo(){return this.Ea}co(){return this.La}lo(t){let i=t.Pa();if(i&&i.length>0&&!this.Ia.vi()){let s=this.Ia.hn();null!==s&&t.Oa(s)}t.rs()}Ka(){let t=this.va();if(0===t.length)return{do:0,Xa:0};let i=0,s=0;for(let e=0;e<t.length;e++){let h=t[e].xi();null!==h&&(h<i&&(i=h),h>s&&(s=h))}return{do:i,Xa:s}}Za(t,i,s){let e=this.ja(i);if(null===e&&(e=this.Va(i,this.gi.V().overlayPriceScales)),this.jl.push(t),!tm(i)){let h=this.Ra.get(i)||[];h.push(t),this.Ra.set(i,h)}e.ma(t),t.Ti(e),t.Ci(s),this.Ga(e),this.$l=null}za(t,i,s){i.Se!==s.Se&&this.lo(t)}Va(t,i){let s=Object.assign({visible:!0,autoScale:!0},K(i)),e=new iU(t,s,this.gi.V().layout,this.gi.V().localization);return e.aa(this.qt()),e}constructor(t,i){this.jl=[],this.Ra=new Map,this.Rl=0,this.oe=0,this.Aa=1e3,this.$l=null,this.Ea=new A,this.Ia=t,this.gi=i,this.La=new iF(this);let s=i.V();this.Ba=this.Va("left",s.leftPriceScale),this.Fa=this.Va("right",s.rightPriceScale),this.Ba.la().l(this.za.bind(this,this.Ba),this),this.Fa.la().l(this.za.bind(this,this.Fa),this),this.Wa(s)}}let iJ=t=>t.getUTCFullYear();class iz{vo(t){var i,s,e;return i=t,s=this.fo,e=this.po,s.replace(/yyyy/g,tb(iJ(i),4)).replace(/yy/g,tb(iJ(i)%100,2)).replace(/MMMM/g,new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(e,{month:"long"})).replace(/MMM/g,new Date(i.getUTCFullYear(),i.getUTCMonth(),1).toLocaleString(e,{month:"short"})).replace(/MM/g,tb(i.getUTCMonth()+1,2)).replace(/dd/g,tb(i.getUTCDate(),2))}constructor(t="yyyy-MM-dd",i="default"){this.fo=t,this.po=i}}class iK{vo(t){return this.mo.replace("%h",tb(t.getUTCHours(),2)).replace("%m",tb(t.getUTCMinutes(),2)).replace("%s",tb(t.getUTCSeconds(),2))}constructor(t){this.mo=t||"%h:%m:%s"}}let iW={wo:"yyyy-MM-dd",bo:"%h:%m:%s",Mo:" ",So:"default"};class iq{vo(t){return"".concat(this.yo.vo(t)).concat(this.xo).concat(this.ko.vo(t))}constructor(t={}){let i=Object.assign(Object.assign({},iW),t);this.yo=new iz(i.wo,i.So),this.ko=new iK(i.bo),this.xo=i.Mo}}class iZ{vo(t){let i=t.rt,s=void 0===i.Ro?new Date(1e3*i.Ao).getTime():new Date(Date.UTC(i.Ro.year,i.Ro.month-1,i.Ro.day)).getTime(),e=this.ne.get(s);if(void 0!==e)return e.Eo;if(this.Co===this.No){let h=this.Po.get(this.Do);this.Po.delete(this.Do),this.ne.delete(F(h)),this.Do++,this.Co--}let l=this.Oo(t);return this.ne.set(s,{Eo:l,Io:this.To}),this.Po.set(this.To,s),this.Co++,this.To++,l}constructor(t,i=50){this.Co=0,this.To=1,this.Do=1,this.ne=new Map,this.Po=new Map,this.Oo=t,this.No=i}}class iH{Hs(){return this.Lo}Us(){return this.Bo}Vo(){return this.Bo-this.Lo+1}Ye(t){return this.Lo<=t&&t<=this.Bo}Mr(t){return this.Lo===t.Hs()&&this.Bo===t.Us()}constructor(t,i){_(t<=i,"right should be >= left"),this.Lo=t,this.Bo=i}}function iY(t,i){return null===t||null===i?t===i:t.Mr(i)}class i${zo(t,i){this.Wo(i),this.ne=null;for(let s=i;s<t.length;++s){let e=t[s],h=this.Fo.get(e.jo);void 0===h&&(h=[],this.Fo.set(e.jo,h)),h.push({pn:s,rt:e.rt,$o:e.jo,Ho:e.Ho})}}Uo(t,i){let s=Math.ceil(i/t);return null!==this.ne&&this.ne.qo===s||(this.ne={pl:this.Yo(s),qo:s}),this.ne.pl}Wo(t){if(0===t)return void this.Fo.clear();let i=[];for(let s of(this.Fo.forEach((s,e)=>{t<=s[0].pn?i.push(e):s.splice(tE(s,t,i=>i.pn<t),1/0)}),i))this.Fo.delete(s)}Yo(t){let i=[];for(let s of Array.from(this.Fo.keys()).sort((t,i)=>i-t)){if(!this.Fo.get(s))continue;let e=i;i=[];let h=e.length,l=0,r=F(this.Fo.get(s)),n=r.length,o=1/0,a=-1/0;for(let u=0;u<n;u++){let c=r[u],f=c.pn;for(;l<h;){let d=e[l],p=d.pn;if(!(p<f)){o=p;break}l++,i.push(d),a=p,o=1/0}o-f>=t&&f-a>=t&&(i.push(c),a=f)}for(;l<h;l++)i.push(e[l])}return i}constructor(){this.Fo=new Map,this.ne=null}}class iQ{Ko(){return null===this.Xo?null:new iH(Math.floor(this.Xo.Hs()),Math.ceil(this.Xo.Us()))}Zo(){return this.Xo}static Go(){return new iQ(null)}constructor(t){this.Xo=t}}(o=b||(b={}))[o.Year=0]="Year",o[o.Month=1]="Month",o[o.DayOfMonth=2]="DayOfMonth",o[o.Time=3]="Time",o[o.TimeWithSeconds=4]="TimeWithSeconds";class iX{V(){return this.Fi}d_(t){D(this.Zl,t),this.f_(),this.c_()}zr(t,i){var s;D(this.Fi,t),this.Fi.fixLeftEdge&&this.p_(),this.Fi.fixRightEdge&&this.v_(),void 0!==t.barSpacing&&this.gi.ks(t.barSpacing),void 0!==t.rightOffset&&this.gi.xs(t.rightOffset),void 0!==t.minBarSpacing&&this.gi.ks(null!==(s=t.barSpacing)&&void 0!==s?s:this.u_),this.f_(),this.c_(),this.h_.m()}Hi(t){var i,s;return null!==(s=null===(i=this.Qo[t])||void 0===i?void 0:i.rt)&&void 0!==s?s:null}Mi(t){var i;return null!==(i=this.Qo[t])&&void 0!==i?i:null}nl(t,i){if(this.Qo.length<1)return null;if(t.Ao>this.Qo[this.Qo.length-1].rt.Ao)return i?this.Qo.length-1:null;let s=tE(this.Qo,t.Ao,(t,i)=>t.rt.Ao<i);return t.Ao<this.Qo[s].rt.Ao?i?s:null:s}vi(){return 0===this.oe||0===this.Qo.length||null===this.Jo}hn(){return this.m_(),this.s_.Ko()}w_(){return this.m_(),this.s_.Zo()}b_(){let t=this.hn();if(null===t)return null;let i={from:t.Hs(),to:t.Us()};return this.g_(i)}g_(t){let i=Math.round(t.from),s=Math.round(t.to),e=T(this.M_()),h=T(this.S_());return{from:T(this.Hi(Math.max(e,i))),to:T(this.Hi(Math.min(h,s)))}}y_(t){return{from:T(this.nl(t.from,!0)),to:T(this.nl(t.to,!0))}}Ut(){return this.oe}qa(t){if(!isFinite(t)||t<=0||this.oe===t)return;let i=this.w_(),s=this.oe;if(this.oe=t,this.n_=!0,this.Fi.lockVisibleTimeRangeOnResize&&0!==s){let e=this.u_*t/s;this.u_=e}this.Fi.fixLeftEdge&&null!==i&&0>=i.Hs()&&(this.__-=Math.round((s-t)/this.u_)+1,this.n_=!0),this.k_(),this.x_()}Ot(t){if(this.vi()||!B(t))return 0;let i=this.C_()+this.__-t;return this.oe-(i+.5)*this.u_-1}on(t,i){let s=this.C_(),e=void 0===i?0:i.from,h=void 0===i?t.length:i.to;for(let l=e;l<h;l++){let r=t[l].rt,n=s+this.__-r,o=this.oe-(n+.5)*this.u_-1;t[l].tt=o}}T_(t){return Math.ceil(this.D_(t))}xs(t){this.n_=!0,this.__=t,this.x_(),this.gi.P_(),this.gi.Wr()}wn(){return this.u_}ks(t){this.O_(t),this.x_(),this.gi.P_(),this.gi.Wr()}N_(){return this.__}pl(){if(this.vi())return null;if(null!==this.a_)return this.a_;let t=this.u_,i=5*(this.gi.V().layout.fontSize+4),s=Math.round(i/t),e=T(this.hn()),h=Math.max(e.Hs(),e.Hs()-s),l=Math.max(e.Us(),e.Us()-s),r=this.t_.Uo(t,i),n=this.M_()+s,o=this.S_()-s,a=this.R_(),u=this.Fi.fixLeftEdge||a,c=this.Fi.fixRightEdge||a,f=0;for(let d of r){let p;h<=d.pn&&d.pn<=l&&(f<this.o_.length?((p=this.o_[f])._l=this.Ot(d.pn),p.Pl=this.A_(d),p.$o=d.$o):(p={E_:!1,_l:this.Ot(d.pn),Pl:this.A_(d),$o:d.$o},this.o_.push(p)),this.u_>i/2&&!a?p.E_=!1:p.E_=u&&d.pn<=n||c&&d.pn>=o,f++)}return this.o_.length=f,this.a_=this.o_,this.o_}I_(){this.n_=!0,this.ks(this.Fi.barSpacing),this.xs(this.Fi.rightOffset)}L_(t){this.n_=!0,this.Jo=t,this.x_(),this.p_()}B_(t,i){let s=this.D_(t),e=this.wn();this.ks(e+i*(e/10)),this.Fi.rightBarStaysOnScroll||this.xs(this.N_()+(s-this.D_(t)))}Sa(t){this.ql&&this.Ta(),null===this.Ul&&null===this.l_&&(this.vi()||(this.Ul=t,this.V_()))}ya(t){if(null===this.l_)return;let i=tU(this.oe-t,0,this.oe),s=tU(this.oe-T(this.Ul),0,this.oe);0!==i&&0!==s&&this.ks(this.l_.wn*i/s)}ka(){null!==this.Ul&&(this.Ul=null,this.F_())}xa(t){null===this.ql&&null===this.l_&&(this.vi()||(this.ql=t,this.V_()))}Ca(t){if(null===this.ql)return;let i=(this.ql-t)/this.wn();this.__=T(this.l_).N_+i,this.n_=!0,this.x_()}Ta(){null!==this.ql&&(this.ql=null,this.F_())}z_(){this.W_(this.Fi.rightOffset)}W_(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400;if(!isFinite(t))throw RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw RangeError("animationDuration (optional) must be finite positive number");let s=this.__,e=performance.now(),h=()=>{let l=(performance.now()-e)/i,r=l>=1;this.xs(r?t:s+(t-s)*l),r||setTimeout(h,20)};h()}dt(t,i){this.n_=!0,this.Qo=t,this.t_.zo(t,i),this.x_()}j_(){return this.e_}H_(){return this.r_}U_(){return this.h_}C_(){return this.Jo||0}q_(t){let i=t.Vo();this.O_(this.oe/i),this.__=t.Us()-this.C_(),this.x_(),this.n_=!0,this.gi.P_(),this.gi.Wr()}Y_(){let t=this.M_(),i=this.S_();null!==t&&null!==i&&this.q_(new iH(t,i+this.Fi.rightOffset))}X_(t){let i=new iH(t.from,t.to);this.q_(i)}Si(t){return void 0!==this.Zl.timeFormatter?this.Zl.timeFormatter(t.Ho):this.K_.vo(new Date(1e3*t.rt.Ao))}R_(){let{handleScroll:t,handleScale:i}=this.gi.V();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||i.axisDoubleClickReset||i.axisPressedMouseMove.time||i.mouseWheel||i.pinch)}M_(){return 0===this.Qo.length?null:0}S_(){return 0===this.Qo.length?null:this.Qo.length-1}Z_(t){return(this.oe-1-t)/this.u_}D_(t){let i=this.Z_(t),s=this.C_()+this.__-i;return Math.round(1e6*s)/1e6}O_(t){let i=this.u_;this.u_=t,this.k_(),i!==this.u_&&(this.n_=!0,this.G_())}m_(){if(!this.n_)return;if(this.n_=!1,this.vi())return void this.J_(iQ.Go());let t=this.C_(),i=this.oe/this.u_,s=this.__+t,e=new iH(s-i+1,s);this.J_(new iQ(e))}k_(){let t=this.Q_();if(this.u_<t&&(this.u_=t,this.n_=!0),0!==this.oe){let i=.5*this.oe;this.u_>i&&(this.u_=i,this.n_=!0)}}Q_(){return this.Fi.fixLeftEdge&&this.Fi.fixRightEdge&&0!==this.Qo.length?this.oe/this.Qo.length:this.Fi.minBarSpacing}x_(){let t=this.tu();this.__>t&&(this.__=t,this.n_=!0);let i=this.iu();null!==i&&this.__<i&&(this.__=i,this.n_=!0)}iu(){let t=this.M_(),i=this.Jo;return null===t||null===i?null:t-i-1+(this.Fi.fixLeftEdge?this.oe/this.u_:Math.min(2,this.Qo.length))}tu(){return this.Fi.fixRightEdge?0:this.oe/this.u_-Math.min(2,this.Qo.length)}V_(){this.l_={wn:this.wn(),N_:this.N_()}}F_(){this.l_=null}A_(t){let i=this.i_.get(t.$o);return void 0===i&&(i=new iZ(t=>this.su(t)),this.i_.set(t.$o,i)),i.vo(t)}su(t){let i=function(t,i,s){switch(t){case 0:case 10:return i?s?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return i?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.$o,this.Fi.timeVisible,this.Fi.secondsVisible);return void 0!==this.Fi.tickMarkFormatter?this.Fi.tickMarkFormatter(t.Ho,i,this.Zl.locale):function(t,i,s){let e={};switch(i){case 0:e.year="numeric";break;case 1:e.month="short";break;case 2:e.month="numeric",e.day="numeric";break;case 3:e.hour12=!1,e.hour="2-digit",e.minute="2-digit";break;case 4:e.hour12=!1,e.hour="2-digit",e.minute="2-digit",e.second="2-digit"}let h=new Date(void 0===t.Ro?1e3*t.Ao:Date.UTC(t.Ro.year,t.Ro.month-1,t.Ro.day));return new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()).toLocaleString(s,e)}(t.rt,i,this.Zl.locale)}J_(t){let i=this.s_;this.s_=t,iY(i.Ko(),this.s_.Ko())||this.e_.m(),iY(i.Zo(),this.s_.Zo())||this.r_.m(),this.G_()}G_(){this.a_=null}f_(){this.G_(),this.i_.clear()}c_(){let t=this.Zl.dateFormat;this.Fi.timeVisible?this.K_=new iq({wo:t,bo:this.Fi.secondsVisible?"%h:%m:%s":"%h:%m",Mo:"   ",So:this.Zl.locale}):this.K_=new iz(t,this.Zl.locale)}p_(){if(!this.Fi.fixLeftEdge)return;let t=this.M_();if(null===t)return;let i=this.hn();if(null===i)return;let s=i.Hs()-t;if(s<0){let e=this.__-s-1;this.xs(e)}this.k_()}v_(){this.x_(),this.k_()}constructor(t,i,s){this.oe=0,this.Jo=null,this.Qo=[],this.ql=null,this.Ul=null,this.t_=new i$,this.i_=new Map,this.s_=iQ.Go(),this.n_=!0,this.e_=new A,this.r_=new A,this.h_=new A,this.l_=null,this.a_=null,this.o_=[],this.Fi=i,this.Zl=s,this.__=i.rightOffset,this.u_=i.barSpacing,this.gi=t,this.c_()}}class i0 extends Q{q(t){}X(t){if(!this.Nt.St)return;t.save();let i=0;for(let s of this.Nt.eu){if(0===s.Jt.length)continue;t.font=s.D;let e=this.ru(t,s.Jt);e>this.Nt.Ut?s.B_=this.Nt.Ut/e:s.B_=1,i+=s.hu*s.B_}let h=0;switch(this.Nt.lu){case"top":h=0;break;case"center":h=Math.max((this.Nt.qt-i)/2,0);break;case"bottom":h=Math.max(this.Nt.qt-i,0)}for(let l of(t.fillStyle=this.Nt.O,this.Nt.eu)){t.save();let r=0;switch(this.Nt.au){case"left":t.textAlign="left",r=l.hu/2;break;case"center":t.textAlign="center",r=this.Nt.Ut/2;break;case"right":t.textAlign="right",r=this.Nt.Ut-1-l.hu/2}t.translate(r,h),t.textBaseline="top",t.font=l.D,t.scale(l.B_,l.B_),t.fillText(l.Jt,0,l.ou),t.restore(),h+=l.hu*l.B_}t.restore()}ru(t,i){let s=this._u(t.font),e=s.get(i);return void 0===e&&(e=t.measureText(i).width,s.set(i,e)),e}_u(t){let i=this.nu.get(t);return void 0===i&&(i=new Map,this.nu.set(t,i)),i}constructor(t){super(),this.nu=new Map,this.Nt=t}}class i1{dt(){this.ut=!0}vt(t,i){return this.ut&&(this.wt(t,i),this.ut=!1),this.Ft}wt(t,i){let s=this.zt.V(),e=this.Vt;e.St=s.visible,e.St&&(e.O=s.color,e.Ut=i,e.qt=t,e.au=s.horzAlign,e.lu=s.vertAlign,e.eu=[{Jt:s.text,D:H(s.fontSize,s.fontFamily,s.fontStyle),hu:1.2*s.fontSize,ou:0,B_:0}])}constructor(t){this.ut=!0,this.Vt={St:!1,O:"",qt:0,Ut:0,eu:[],lu:"center",au:"center"},this.Ft=new i0(this.Vt),this.zt=t}}class i2 extends tp{ns(){return[]}ss(){return[this.qi]}V(){return this.Fi}rs(){this.qi.dt()}constructor(t,i){super(),this.Fi=i,this.qi=new i1(this)}}(a=M||(M={}))[a.OnTouchEnd=0]="OnTouchEnd",a[a.OnNextTap=1]="OnNextTap";class i3{Rh(){this.Cu(new tg(3))}Wr(){this.Cu(new tg(2))}Uh(){this.Cu(new tg(1))}Ah(t){let i=this.Tu(t);this.Cu(i)}Du(){return this.fu}Pu(t){let i=this.fu;this.fu=t,null!==i&&this.Ah(i.Ou),null!==t&&this.Ah(t.Ou)}V(){return this.Fi}zr(t){D(this.Fi,t),this.uu.forEach(i=>i.Wa(t)),void 0!==t.timeScale&&this.Ia.zr(t.timeScale),void 0!==t.localization&&this.Ia.d_(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.pu.m(),this.yu=this.ku(0),this.xu=this.ku(1),this.Rh()}Nu(t,i){if("left"===t)return void this.zr({leftPriceScale:i});if("right"===t)return void this.zr({rightPriceScale:i});let s=this.Ru(t);null!==s&&(s.Ct.zr(i),this.pu.m())}Ru(t){for(let i of this.uu){let s=i.ja(t);if(null!==s)return{Wt:i,Ct:s}}return null}gt(){return this.Ia}Au(){return this.uu}Eu(){return this.Mu}Iu(){return this.ct}Lu(){return this.vu}Bu(t,i){t.aa(i),this.P_()}qa(t){this.oe=t,this.Ia.qa(this.oe),this.uu.forEach(i=>i.qa(t)),this.P_()}Su(t){let i=new iB(this.Ia,this);void 0!==t?this.uu.splice(t,0,i):this.uu.push(i);let s=void 0===t?this.uu.length-1:t,e=new tg(3);return e.fs(s,{ps:0,vs:!0}),this.Cu(e),i}io(t,i,s){t.io(i,s)}so(t,i,s){t.so(i,s),this.Eh(),this.Cu(this.Vu(t,2))}no(t,i){t.no(i),this.Cu(this.Vu(t,2))}eo(t,i,s){i.sa()||t.eo(i,s)}ro(t,i,s){i.sa()||(t.ro(i,s),this.Eh(),this.Cu(this.Vu(t,2)))}ho(t,i){i.sa()||(t.ho(i),this.Cu(this.Vu(t,2)))}ao(t,i){t.ao(i),this.Cu(this.Vu(t,2))}Fu(t){this.Ia.Sa(t)}zu(t,i){let s=this.gt();if(s.vi()||0===i)return;let e=s.Ut();t=Math.max(1,Math.min(t,e)),s.B_(t,i),this.P_()}Wu(t){this.ju(0),this.$u(t),this.Hu()}Uu(t){this.Ia.ya(t),this.P_()}qu(){this.Ia.ka(),this.Wr()}ju(t){this.du=t,this.Ia.xa(t)}$u(t){let i=!1;return null!==this.du&&Math.abs(t-this.du)>20&&(this.du=null,i=!0),this.Ia.Ca(t),this.P_(),i}Hu(){this.Ia.Ta(),this.Wr(),this.du=null}ft(){return this.cu}Yu(t,i,s){this.ct.Yi(t,i);let e=NaN,h=this.Ia.T_(t),l=this.Ia.hn();null!==l&&(h=Math.min(Math.max(l.Hs(),h),l.Us()));let r=s.ji(),n=r.yt();null!==n&&(e=r.$i(i,n)),e=this.gu.el(e,h,s),this.ct.Gi(h,e,s),this.Uh(),this.vu.m(this.ct.bt(),{x:t,y:i})}Xu(){this.Iu().Qi(),this.Uh(),this.vu.m(null,null)}Eh(){let t=this.ct.Wt();if(null!==t){let i=this.ct.Ki(),s=this.ct.Zi();this.Yu(i,s,t)}this.ct.rs()}Ku(t,i,s){let e=this.Ia.Hi(0);void 0!==i&&void 0!==s&&this.Ia.dt(i,s);let h=this.Ia.Hi(0),l=this.Ia.C_(),r=this.Ia.hn();if(null!==r&&null!==e&&null!==h){let n=r.Ye(l),o=e.Ao>h.Ao,a=n&&this.Ia.V().shiftVisibleRangeOnNewBar;null===t||!(t>l)||o||a||this.Ia.xs(this.Ia.N_()-(t-l))}this.Ia.L_(t)}Bh(t){null!==t&&t._o()}fe(t){let i=this.uu.find(i=>i.va().includes(t));return void 0===i?null:i}P_(){this.Mu.rs(),this.uu.forEach(t=>t._o()),this.Eh()}M(){this.uu.forEach(t=>t.M()),this.uu.length=0,this.Fi.localization.priceFormatter=void 0,this.Fi.localization.timeFormatter=void 0}Zu(){return this.bu}we(){return this.bu.V()}$a(){return this.pu}Gu(t,i){let s=this.uu[0],e=this.Ju(i,t,s);return this.cu.push(e),1===this.cu.length?this.Rh():this.Wr(),e}Qu(t){let i=this.fe(t),s=this.cu.indexOf(t);_(-1!==s,"Series not found"),this.cu.splice(s,1),T(i).ba(t),t.M&&t.M()}Nh(t,i){let s=T(this.fe(t));s.ba(t);let e=this.Ru(i);if(null===e){let h=t.xi();s.ma(t,i,h)}else{let l=e.Wt===s?t.xi():void 0;e.Wt.ma(t,i,l)}}Y_(){let t=new tg(2);t.gs(),this.Cu(t)}tc(t){let i=new tg(2);i.Ss(t),this.Cu(i)}ys(){let t=new tg(2);t.ys(),this.Cu(t)}ks(t){let i=new tg(2);i.ks(t),this.Cu(i)}xs(t){let i=new tg(2);i.xs(t),this.Cu(i)}ic(){return this.Fi.rightPriceScale.visible?"right":"left"}sc(){return this.xu}nc(){return this.yu}Pt(t){let i=this.xu,s=this.yu;if(i===s)return i;if(t=Math.max(0,Math.min(100,Math.round(100*t))),null===this.mu||this.mu.zs!==s||this.mu.Ws!==i)this.mu={zs:s,Ws:i,ec:new Map};else{let e=this.mu.ec.get(t);if(void 0!==e)return e}let h=function(t,i,s){let[e,h,l,r]=G(t),[n,o,a,u]=G(i),c=[I(e+s*(n-e)),I(h+s*(o-h)),I(l+s*(a-l)),O(r+s*(u-r))];return"rgba(".concat(c[0],", ").concat(c[1],", ").concat(c[2],", ").concat(c[3],")")}(s,i,t/100);return this.mu.ec.set(t,h),h}Vu(t,i){let s=new tg(i);if(null!==t){let e=this.uu.indexOf(t);s.fs(e,{ps:i})}return s}Tu(t,i){return void 0===i&&(i=2),this.Vu(this.fe(t),i)}Cu(t){this.wu&&this.wu(t),this.uu.forEach(t=>t.co().vl().dt())}Ju(t,i,s){let e=new iC(this,t,i),h=void 0!==t.priceScaleId?t.priceScaleId:this.ic();return s.ma(e,h),tm(h)||e.zr(t),e}ku(t){let i=this.Fi.layout;return"gradient"===i.background.type?0===t?i.background.topColor:i.background.bottomColor:i.background.color}constructor(t,i){this.uu=[],this.cu=[],this.oe=0,this.du=null,this.fu=null,this.pu=new A,this.vu=new A,this.mu=null,this.wu=t,this.Fi=i,this.bu=new Y(this),this.Ia=new iX(this,i.timeScale,this.Fi.localization),this.ct=new tv(this,i.crosshair),this.gu=new iS(i.crosshair),this.Mu=new i2(this,i.watermark),this.Su(),this.uu[0].Ua(2e3),this.yu=this.ku(0),this.xu=this.ku(1)}}function i5(t){void 0!==t.borderColor&&(t.borderUpColor=t.borderColor,t.borderDownColor=t.borderColor),void 0!==t.wickColor&&(t.wickUpColor=t.wickColor,t.wickDownColor=t.wickColor)}function i6(t){return!U(t)&&!J(t)}(u=w||(w={}))[u.Disabled=0]="Disabled",u[u.Continuous=1]="Continuous",u[u.OnDataUpdate=2]="OnDataUpdate",(c=N||(N={}))[c.LastBar=0]="LastBar",c[c.LastVisible=1]="LastVisible",(f=y||(y={})).Solid="solid",f.VerticalGradient="gradient";class i4{Mr(t){return this.Et===t.Et&&this.It===t.It}constructor(t,i){this.Et=t,this.It=i}}function i8(t){return t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.devicePixelRatio||1}function i9(t){let i=T(t.getContext("2d"));return i.setTransform(1,0,0,1,0,0),i}function i7(t,i){let s=t.createElement("canvas"),e=i8(s);return s.style.width="".concat(i.Et,"px"),s.style.height="".concat(i.It,"px"),s.width=i.Et*e,s.height=i.It*e,s}function st(t,i){let s=T(t.ownerDocument).createElement("canvas");t.appendChild(s);let e=(0,C.f)(s,{allowDownsampling:!1});return e.resizeCanvas({width:i.Et,height:i.It}),e}function si(t,i,s){let e=(t.rc-i.rc)/(t.rt-i.rt);return Math.sign(e)*Math.min(Math.abs(e),s)}class ss{wc(t,i){if(null!==this.hc){if(this.hc.rt===i)return void(this.hc.rc=t);if(Math.abs(this.hc.rc-t)<this.Ps)return}this.oc=this.ac,this.ac=this.lc,this.lc=this.hc,this.hc={rt:i,rc:t}}De(t,i){var s,e,h,l,r,n;if(null===this.hc||null===this.lc||i-this.hc.rt>50)return;let o=0,a=si(this.hc,this.lc,this.vc),u=(s=this.hc,e=this.lc,s.rc-e.rc),c=[a],f=[u];if(o+=u,null!==this.ac){let d=si(this.lc,this.ac,this.vc);if(Math.sign(d)===Math.sign(a)){let p=(h=this.lc,l=this.ac,h.rc-l.rc);if(c.push(d),f.push(p),o+=p,null!==this.oc){let v=si(this.ac,this.oc,this.vc);if(Math.sign(v)===Math.sign(a)){let m=(r=this.ac,n=this.oc,r.rc-n.rc);c.push(v),f.push(m),o+=m}}}}let g=0;for(let b=0;b<c.length;++b)g+=f[b]/o*c[b];Math.abs(g)<this.fc||(this._c={rc:t,rt:i},this.cc=g,this.uc=function(t,i){let s=Math.log(i);return Math.log(-(1*s/t))/s}(Math.abs(g),this.mc))}bc(t){let i=T(this._c),s=t-i.rt;return i.rc+this.cc*(Math.pow(this.mc,s)-1)/Math.log(this.mc)}gc(t){return null===this._c||this.Mc(t)===this.uc}Sc(){return this.dc}yc(){this.dc=!0}Mc(t){let i=t-T(this._c).rt;return Math.min(i,this.uc)}constructor(t,i,s,e){this.hc=null,this.lc=null,this.ac=null,this.oc=null,this._c=null,this.uc=0,this.cc=0,this.dc=!1,this.fc=t,this.vc=i,this.mc=s,this.Ps=e}}function se(){return window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function sh(){return/iPhone|iPad|iPod/.test(window.navigator.platform)}class sl{M(){null!==this.Bc&&(this.Bc(),this.Bc=null),null!==this.Vc&&(this.Vc(),this.Vc=null),null!==this.zc&&(this.zc(),this.zc=null),null!==this.Wc&&(this.Wc(),this.Wc=null),null!==this.jc&&(this.jc(),this.jc=null),null!==this.Fc&&(this.Fc(),this.Fc=null),this.pd(),this.ud()}vd(t){this.zc&&this.zc();let i=this.md.bind(this);if(this.zc=()=>{this.dd.removeEventListener("mousemove",i)},this.dd.addEventListener("mousemove",i),this.td(t))return;let s=this.sd(t);this.od(s,this.ld.wd),this.Zc=!0}ud(){null!==this.xc&&clearTimeout(this.xc),this.kc=0,this.xc=null,this.Cc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}}ad(){null!==this.Dc&&clearTimeout(this.Dc),this.Tc=0,this.Dc=null,this.Pc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}}md(t){if(this.Yc||null!==this.Ac||this.td(t))return;let i=this.sd(t);this.od(i,this.ld.bd),this.Zc=!0}gd(t){let i=su(t.changedTouches,T(this.Kc));if(null===i||(this.Xc=sa(t),null!==this.$c)||this.qc)return;this.Uc=!0;let s=this.ed(so(i),T(this.Ac)),{Md:e,Sd:h,nd:l}=s;if(this.Ec||!(l<5)){if(!this.Ec){let r=.5*e,n=h>=r&&!this.Fi.yd(),o=r>h&&!this.Fi.kd();n||o||(this.qc=!0),this.Ec=!0,this.Lc=!0,this.pd(),this.ad()}if(!this.qc){let a=this.sd(t,i);this.rd(a,this.ld.xd),sn(t)}}}Cd(t){if(0!==t.button)return;let i=this.ed(so(t),T(this.Rc)),{nd:s}=i;if(s>=5&&(this.Ic=!0,this.ud()),this.Ic){let e=this.sd(t);this.od(e,this.ld.Td)}}ed(t,i){let s=Math.abs(i.tt-t.tt),e=Math.abs(i.it-t.it);return{Md:s,Sd:e,nd:s+e}}Dd(t){let i=su(t.changedTouches,T(this.Kc));if(null===i&&0===t.touches.length&&(i=t.changedTouches[0]),null===i)return;this.Kc=null,this.Xc=sa(t),this.pd(),this.Ac=null,this.jc&&(this.jc(),this.jc=null);let s=this.sd(t,i);if(this.rd(s,this.ld.Pd),++this.Tc,this.Dc&&this.Tc>1){let{nd:e}=this.ed(so(i),this.Pc);e<30&&!this.Lc&&this.rd(s,this.ld.hd),this.ad()}else this.Lc||(this.rd(s,this.ld.Od),this.ld.Od&&sn(t));0===this.Tc&&sn(t),0===t.touches.length&&this.Nc&&(this.Nc=!1,sn(t))}Jc(t){if(0!==t.button)return;let i=this.sd(t);if(this.Rc=null,this.Yc=!1,this.Wc&&(this.Wc(),this.Wc=null),se()&&this.dd.ownerDocument.documentElement.removeEventListener("mouseleave",this.Gc),!this.td(t)){if(this.od(i,this.ld.Nd),++this.kc,this.xc&&this.kc>1){let{nd:s}=this.ed(so(t),this.Cc);s<5&&!this.Ic&&this.od(i,this.ld._d),this.ud()}else this.Ic||this.od(i,this.ld.Rd)}}pd(){null!==this.Oc&&(clearTimeout(this.Oc),this.Oc=null)}Ad(t){if(null!==this.Kc)return;let i=t.changedTouches[0];this.Kc=i.identifier,this.Xc=sa(t);let s=this.dd.ownerDocument.documentElement;this.Lc=!1,this.Ec=!1,this.qc=!1,this.Ac=so(i),this.jc&&(this.jc(),this.jc=null);{let e=this.gd.bind(this),h=this.Dd.bind(this);this.jc=()=>{s.removeEventListener("touchmove",e),s.removeEventListener("touchend",h)},s.addEventListener("touchmove",e,{passive:!1}),s.addEventListener("touchend",h,{passive:!1}),this.pd(),this.Oc=setTimeout(this.Ed.bind(this,t),240)}let l=this.sd(t,i);this.rd(l,this.ld.Id),this.Dc||(this.Tc=0,this.Dc=setTimeout(this.ad.bind(this),500),this.Pc=so(i))}Ld(t){if(0!==t.button)return;let i=this.dd.ownerDocument.documentElement;se()&&i.addEventListener("mouseleave",this.Gc),this.Ic=!1,this.Rc=so(t),this.Wc&&(this.Wc(),this.Wc=null);{let s=this.Cd.bind(this),e=this.Jc.bind(this);this.Wc=()=>{i.removeEventListener("mousemove",s),i.removeEventListener("mouseup",e)},i.addEventListener("mousemove",s),i.addEventListener("mouseup",e)}if(this.Yc=!0,this.td(t))return;let h=this.sd(t);this.od(h,this.ld.Bd),this.xc||(this.kc=0,this.xc=setTimeout(this.ud.bind(this),500),this.Cc=so(t))}fd(){var t;this.dd.addEventListener("mouseenter",this.vd.bind(this)),this.dd.addEventListener("touchcancel",this.pd.bind(this));{let i=this.dd.ownerDocument,s=t=>{this.ld.Vd&&(t.target&&this.dd.contains(t.target)||this.ld.Vd())};this.Vc=()=>{i.removeEventListener("touchstart",s)},this.Bc=()=>{i.removeEventListener("mousedown",s)},i.addEventListener("mousedown",s),i.addEventListener("touchstart",s,{passive:!0})}sh()&&(this.Fc=()=>{this.dd.removeEventListener("dblclick",this.Qc)},this.dd.addEventListener("dblclick",this.Qc)),this.dd.addEventListener("mouseleave",this.Fd.bind(this)),this.dd.addEventListener("touchstart",this.Ad.bind(this),{passive:!0}),t=this.dd,void 0===window.chrome||t.addEventListener("mousedown",t=>{if(1===t.button)return t.preventDefault(),!1}),this.dd.addEventListener("mousedown",this.Ld.bind(this)),this.zd(),this.dd.addEventListener("touchmove",()=>{},{passive:!1})}zd(){void 0===this.ld.Wd&&void 0===this.ld.jd&&void 0===this.ld.$d||(this.dd.addEventListener("touchstart",t=>this.Hd(t.touches),{passive:!0}),this.dd.addEventListener("touchmove",t=>{if(2===t.touches.length&&null!==this.$c&&void 0!==this.ld.jd){let i=sr(t.touches[0],t.touches[1])/this.Hc;this.ld.jd(this.$c,i),sn(t)}},{passive:!1}),this.dd.addEventListener("touchend",t=>{this.Hd(t.touches)}))}Hd(t){1===t.length&&(this.Uc=!1),2!==t.length||this.Uc||this.Nc?this.Ud():this.qd(t)}qd(t){let i=this.dd.getBoundingClientRect()||{left:0,top:0};this.$c={tt:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,it:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.Hc=sr(t[0],t[1]),void 0!==this.ld.Wd&&this.ld.Wd(),this.pd()}Ud(){null!==this.$c&&(this.$c=null,void 0!==this.ld.$d&&this.ld.$d())}Fd(t){if(this.zc&&this.zc(),this.td(t)||!this.Zc)return;let i=this.sd(t);this.od(i,this.ld.Yd),this.Zc=!sh()}Ed(t){let i=su(t.touches,T(this.Kc));if(null===i)return;let s=this.sd(t,i);this.rd(s,this.ld.Xd),this.Lc=!0,this.Nc=!0}td(t){return t.sourceCapabilities&&void 0!==t.sourceCapabilities.firesTouchEvents?t.sourceCapabilities.firesTouchEvents:sa(t)<this.Xc+500}rd(t,i){i&&i.call(this.ld,t)}od(t,i){i&&i.call(this.ld,t)}sd(t,i){let s=i||t,e=this.dd.getBoundingClientRect()||{left:0,top:0};return{Kd:s.clientX,Zd:s.clientY,Gd:s.pageX,Jd:s.pageY,Qd:s.screenX,tf:s.screenY,if:s.clientX-e.left,sf:s.clientY-e.top,nf:t.ctrlKey,ef:t.altKey,rf:t.shiftKey,hf:t.metaKey,lf:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,af:t.type,_f:s.target,uf:t.view,cf(){"touchstart"!==t.type&&sn(t)}}}constructor(t,i,s){this.kc=0,this.xc=null,this.Cc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.Tc=0,this.Dc=null,this.Pc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.Oc=null,this.Nc=!1,this.Rc=null,this.Ac=null,this.Ec=!1,this.Ic=!1,this.Lc=!1,this.Bc=null,this.Vc=null,this.Fc=null,this.zc=null,this.Wc=null,this.jc=null,this.$c=null,this.Hc=0,this.Uc=!1,this.qc=!1,this.Yc=!1,this.Xc=0,this.Kc=null,this.Zc=!sh(),this.Gc=t=>{this.Jc(t)},this.Qc=t=>{if(this.td(t)){let i=this.sd(t);if(++this.Tc,this.Dc&&this.Tc>1){let{nd:s}=this.ed(so(t),this.Pc);s<30&&!this.Lc&&this.rd(i,this.ld.hd),this.ad()}}else{let e=this.sd(t);if(++this.kc,this.xc&&this.kc>1){let{nd:h}=this.ed(so(t),this.Cc);h<5&&!this.Ic&&this.od(e,this.ld._d),this.ud()}}},this.dd=t,this.ld=i,this.Fi=s,this.fd()}}function sr(t,i){let s=t.clientX-i.clientX,e=t.clientY-i.clientY;return Math.sqrt(s*s+e*e)}function sn(t){t.cancelable&&t.preventDefault()}function so(t){return{tt:t.pageX,it:t.pageY}}function sa(t){return t.timeStamp||performance.now()}function su(t,i){for(let s=0;s<t.length;++s)if(t[s].identifier===i)return t[s];return null}class sc{M(){this._e.he(),this.re=[],this.ff.clear()}pf(t,i,s,e,h){let l=this.vf(t,i);if("left"!==h){let r=i8(t.canvas);s-=Math.floor(l.mf*r)}e-=Math.floor(l.qt/2),t.drawImage(l.wf,s,e,l.Ut,l.qt)}vf(t,i){let s;if(this.ff.has(i))s=F(this.ff.get(i));else{if(this.re.length>=200){let e=F(this.re.shift());this.ff.delete(e)}let h=i8(t.canvas),l=Math.ceil(this.F/4.5),r=Math.round(this.F/10),n=Math.ceil(this._e.Qt(t,i)),o=tJ(Math.round(n+2*l)),a=tJ(this.F+2*l),u=i7(document,new i4(o,a));s={Jt:i,mf:Math.round(Math.max(1,n)),Ut:Math.ceil(o*h),qt:Math.ceil(a*h),wf:u},0!==n&&(this.re.push(s.Jt),this.ff.set(s.Jt,s)),tl(t=i9(s.wf),h,()=>{t.font=this.Ke,t.fillStyle=this.df,t.fillText(i,0,a-l-r)})}return s}constructor(t,i,s,e){this._e=new t1(200),this.F=0,this.df="",this.Ke="",this.re=[],this.ff=new Map,this.F=t,this.df=i,this.Ke=H(t,s,e)}}class sf{M(){this.zf.M(),this.Rf.unsubscribeCanvasConfigured(this.Df),this.Rf.destroy(),this.Nf.unsubscribeCanvasConfigured(this.xf),this.Nf.destroy(),null!==this.fi&&this.fi.Ma().v(this),this.fi=null,this.Sf.M()}Wf(){return this.Of}et(){return T(this.fi).V().borderColor}jf(){return this.Fi.textColor}T(){return this.Fi.fontSize}$f(){return H(this.T(),this.Fi.fontFamily)}Hf(){let t=this.bu.V(),i=this.df!==t.O,s=this.Ke!==t.D;return(i||s)&&(this.Cf(t),this.df=t.O),s&&(this.Mf.he(),this.Ke=t.D),t}Uf(){if(null===this.fi)return 0;let t=0,i=this.Hf(),s=i9(this.Nf.canvas),e=this.fi.pl();s.font=this.$f(),e.length>0&&(t=Math.max(this.Mf.Qt(s,e[0].Pl),this.Mf.Qt(s,e[e.length-1].Pl)));let h=this.qf();for(let l=h.length;l--;){let r=this.Mf.Qt(s,h[l].Jt());r>t&&(t=r)}let n=this.fi.yt();if(null!==n&&null!==this.bf){let o=this.fi.$i(1,n),a=this.fi.$i(this.bf.It-2,n);t=Math.max(t,this.Mf.Qt(s,this.fi.mi(Math.floor(Math.min(o,a))+.11111111111111,n)),this.Mf.Qt(s,this.fi.mi(Math.ceil(Math.max(o,a))-.11111111111111,n)))}let u=t||34,c=Math.ceil(i.k+i.C+i.R+i.A+u);return c+c%2}Yf(t){if(t.Et<0||t.It<0)throw Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));null!==this.bf&&this.bf.Mr(t)||(this.bf=t,this.kf=!0,this.Nf.resizeCanvas({width:t.Et,height:t.It}),this.Rf.resizeCanvas({width:t.Et,height:t.It}),this.kf=!1,this.Of.style.width=t.Et+"px",this.Of.style.height=t.It+"px",this.Of.style.minWidth=t.Et+"px")}Xf(){return T(this.bf).Et}Ti(t){this.fi!==t&&(null!==this.fi&&this.fi.Ma().v(this),this.fi=t,t.Ma().l(this.zl.bind(this),this))}Ct(){return this.fi}he(){let t=this.Pi.Kf();this.Pi.Tf().jt().ao(t,T(this.Ct()))}Zf(t){if(null===this.bf)return;if(1!==t){let i=i9(this.Nf.canvas);this.Gf(),this.Jf(i,this.Nf.pixelRatio),this.Un(i,this.Nf.pixelRatio),this.Qf(i,this.Nf.pixelRatio),this.tp(i,this.Nf.pixelRatio)}let s=i9(this.Rf.canvas),e=this.bf.Et,h=this.bf.It;tl(s,this.Rf.pixelRatio,()=>{s.clearRect(0,0,e,h)}),this.ip(s,this.Rf.pixelRatio)}sp(){return this.Nf.canvas}dt(){var t;null===(t=this.fi)||void 0===t||t.pl()}Af(t){if(null===this.fi||this.fi.vi()||!this.Pi.Tf().V().handleScale.axisPressedMouseMove.price)return;let i=this.Pi.Tf().jt(),s=this.Pi.Kf();this.gf=!0,i.io(s,this.fi,t.sf)}Ef(t){if(null===this.fi||!this.Pi.Tf().V().handleScale.axisPressedMouseMove.price)return;let i=this.Pi.Tf().jt(),s=this.Pi.Kf(),e=this.fi;i.so(s,e,t.sf)}If(){if(null===this.fi||!this.Pi.Tf().V().handleScale.axisPressedMouseMove.price)return;let t=this.Pi.Tf().jt(),i=this.Pi.Kf(),s=this.fi;this.gf&&(this.gf=!1,t.no(i,s))}Lf(t){if(null===this.fi||!this.Pi.Tf().V().handleScale.axisPressedMouseMove.price)return;let i=this.Pi.Tf().jt(),s=this.Pi.Kf();this.gf=!1,i.no(s,this.fi)}Bf(t){this.Pi.Tf().V().handleScale.axisDoubleClickReset&&this.he()}Vf(t){null!==this.fi&&(!this.Pi.Tf().jt().V().handleScale.axisPressedMouseMove.price||this.fi.vr()||this.fi.na()||this.np(1))}Ff(t){this.np(0)}qf(){let t=[],i=null===this.fi?void 0:this.fi;return(s=>{for(let e=0;e<s.length;++e){let h=s[e].ns(this.Pi.Kf(),i);for(let l=0;l<h.length;l++)t.push(h[l])}})(this.Pi.Kf().va()),t}Jf(t,i){if(null===this.bf)return;let s=this.bf.Et,e=this.bf.It;tl(t,i,()=>{let i=this.Pi.Kf().jt(),h=i.nc(),l=i.sc();h===l?tr(t,0,0,s,e,h):tn(t,0,0,s,e,h,l)})}Un(t,i){let s;if(null===this.bf||null===this.fi||!this.fi.V().borderVisible)return;t.save(),t.fillStyle=this.et();let e=Math.max(1,Math.floor(this.Hf().k*i));s=this.Pf?Math.floor(this.bf.Et*i)-e:0,t.fillRect(s,0,e,Math.ceil(this.bf.It*i)),t.restore()}Qf(t,i){if(null===this.bf||null===this.fi)return;let s=this.fi.pl();t.save(),t.strokeStyle=this.et(),t.font=this.$f(),t.fillStyle=this.et();let e=this.Hf(),h=this.Pf?Math.floor((this.bf.Et-e.C)*i-e.k*i):Math.floor(e.k*i),l=this.Pf?Math.round(h-e.R*i):Math.round(h+e.C*i+e.R*i),r=this.Pf?"right":"left",n=Math.max(1,Math.floor(i)),o=Math.floor(.5*i),a=this.fi.V();if(a.borderVisible&&a.ticksVisible){let u=Math.round(e.C*i);for(let c of(t.beginPath(),s))t.rect(h,Math.round(c._l*i)-o,u,n);t.fill()}for(let f of(t.fillStyle=this.jf(),s))this.Sf.pf(t,f.Pl,l,Math.round(f._l*i),r);t.restore()}Gf(){if(null===this.bf||null===this.fi)return;let t=this.bf.It/2,i=[],s=this.fi.va().slice(),e=this.Pi.Kf(),h=this.Hf();this.fi===e.ve()&&this.Pi.Kf().va().forEach(t=>{e.pe(t)&&s.push(t)});let l=this.fi.rl()[0],r=this.fi;s.forEach(s=>{let h=s.ns(e,r);h.forEach(t=>{t.oi(null),t._i()&&i.push(t)}),l===s&&h.length>0&&(t=h[0].ti())});let n=i.filter(i=>i.ti()<=t),o=i.filter(i=>i.ti()>t);if(n.sort((t,i)=>i.ti()-t.ti()),n.length&&o.length&&o.push(n[0]),o.sort((t,i)=>t.ti()-i.ti()),i.forEach(t=>t.oi(t.ti())),this.fi.V().alignLabels){for(let a=1;a<n.length;a++){let u=n[a],c=n[a-1],f=c.qt(h,!1),d=u.ti(),p=c.ai();d>p-f&&u.oi(p-f)}for(let v=1;v<o.length;v++){let m=o[v],g=o[v-1],b=g.qt(h,!0),M=m.ti(),w=g.ai();M<w+b&&m.oi(w+b)}}}tp(t,i){if(null===this.bf)return;t.save();let s=this.bf,e=this.qf(),h=this.Hf(),l=this.Pf?"right":"left";e.forEach(e=>{if(e.ui()){let r=e.vt(T(this.fi));t.save(),r.U(t,h,this.Mf,s.Et,l,i),t.restore()}}),t.restore()}ip(t,i){if(null===this.bf||null===this.fi)return;t.save();let s=this.bf,e=this.Pi.Tf().jt(),h=[],l=this.Pi.Kf(),r=e.Iu().ns(l,this.fi);r.length&&h.push(r);let n=this.Hf(),o=this.Pf?"right":"left";h.forEach(e=>{e.forEach(e=>{t.save(),e.vt(T(this.fi)).U(t,n,this.Mf,s.Et,o,i),t.restore()})}),t.restore()}np(t){this.Of.style.cursor=1===t?"ns-resize":"default"}zl(){let t=this.Uf();this.yf<t&&this.Pi.Tf().jt().Rh(),this.yf=t}Cf(t){this.Sf.M(),this.Sf=new sc(t.T,t.O,t.P)}constructor(t,i,s,e){this.fi=null,this.bf=null,this.gf=!1,this.Mf=new t1(50),this.Sf=new sc(11,"#000"),this.df=null,this.Ke=null,this.yf=0,this.kf=!1,this.xf=()=>{this.Cf(this.bu.V()),this.kf||this.Pi.Tf().jt().Wr()},this.Df=()=>{this.kf||this.Pi.Tf().jt().Wr()},this.Pi=t,this.Fi=i,this.bu=s,this.Pf="left"===e,this.Of=document.createElement("div"),this.Of.style.height="100%",this.Of.style.overflow="hidden",this.Of.style.width="25px",this.Of.style.left="0",this.Of.style.position="relative",this.Nf=st(this.Of,new i4(16,16)),this.Nf.subscribeCanvasConfigured(this.xf);let h=this.Nf.canvas;h.style.position="absolute",h.style.zIndex="1",h.style.left="0",h.style.top="0",this.Rf=st(this.Of,new i4(16,16)),this.Rf.subscribeCanvasConfigured(this.Df);let l=this.Rf.canvas;l.style.position="absolute",l.style.zIndex="2",l.style.left="0",l.style.top="0";let r={Bd:this.Af.bind(this),Id:this.Af.bind(this),Td:this.Ef.bind(this),xd:this.Ef.bind(this),Vd:this.If.bind(this),Nd:this.Lf.bind(this),Pd:this.Lf.bind(this),_d:this.Bf.bind(this),hd:this.Bf.bind(this),wd:this.Vf.bind(this),Yd:this.Ff.bind(this)};this.zf=new sl(this.Rf.canvas,r,{yd:()=>!1,kd:()=>!0})}}function sd(t,i,s,e,h){t.Y&&t.Y(i,s,e,h)}function sp(t,i,s,e,h){t.U(i,s,e,h)}function sv(t,i){return t.ss(i)}function sm(t,i){return void 0!==t.Hh?t.Hh(i):[]}class sg{M(){null!==this.ep&&this.ep.M(),null!==this.rp&&this.rp.M(),this.Rf.unsubscribeCanvasConfigured(this.Df),this.Rf.destroy(),this.Nf.unsubscribeCanvasConfigured(this.xf),this.Nf.destroy(),null!==this.pp&&this.pp.uo().v(this),this.zf.M()}Kf(){return T(this.pp)}yp(t){null!==this.pp&&this.pp.uo().v(this),this.pp=t,null!==this.pp&&this.pp.uo().l(sg.prototype.mp.bind(this),this,!0),this.Sp()}Tf(){return this.vp}Wf(){return this.Mp}Sp(){if(null!==this.pp&&(this.kp(),0!==this.gi().ft().length)){if(null!==this.ep){let t=this.pp.Ja();this.ep.Ti(T(t))}if(null!==this.rp){let i=this.pp.Qa();this.rp.Ti(T(i))}}}xp(){null!==this.ep&&this.ep.dt(),null!==this.rp&&this.rp.dt()}Ha(){return null!==this.pp?this.pp.Ha():0}Ua(t){this.pp&&this.pp.Ua(t)}wd(t){if(!this.pp)return;this.Cp();let i=t.if,s=t.sf;this.Tp(i,s)}Bd(t){this.Cp(),this.Dp(),this.Tp(t.if,t.sf)}bd(t){if(!this.pp)return;this.Cp();let i=t.if,s=t.sf;this.Tp(i,s);let e=this.Ze(i,s);this.gi().Pu(e&&{Ou:e.Ou,Pp:e.Pp})}Rd(t){if(null===this.pp)return;this.Cp();let i=t.if,s=t.sf;if(this.ap.g()){let e=this.gi().Iu().bt();this.ap.m(e,{x:i,y:s})}}Td(t){this.Cp(),this.Op(t),this.Tp(t.if,t.sf)}Nd(t){null!==this.pp&&(this.Cp(),this._p=!1,this.Np(t))}Xd(t){if(this._p=!0,null===this.up){let i={x:t.if,y:t.sf};this.Rp(i,i)}}Yd(t){null!==this.pp&&(this.Cp(),this.pp.jt().Pu(null),this.Ap())}Ep(){return this.ap}Wd(){this.op=1,this.Ip()}jd(t,i){if(!this.vp.V().handleScale.pinch)return;let s=5*(i-this.op);this.op=i,this.gi().zu(t.tt,s)}Id(t){if(this._p=!1,this.cp=null!==this.up,this.Dp(),null!==this.up){let i=this.gi().Iu();this.dp={x:i.Yt(),y:i.Xt()},this.up={x:t.if,y:t.sf}}}xd(t){if(null===this.pp)return;let i=t.if,s=t.sf;if(null===this.up)this.Op(t);else{this.cp=!1;let e=T(this.dp),h=e.x+(i-this.up.x),l=e.y+(s-this.up.y);this.Tp(h,l)}}Pd(t){0===this.Tf().V().trackingMode.exitMode&&(this.cp=!0),this.Lp(),this.Np(t)}Ze(t,i){let s=this.pp;if(null===s)return null;let e=s.va();for(let h of e){let l=this.Bp(h.ss(s),t,i);if(null!==l)return{Ou:h,uf:l.uf,Pp:l.Pp}}return null}Vp(t,i){T("left"===i?this.ep:this.rp).Yf(new i4(t,this.bf.It))}Fp(){return this.bf}Yf(t){if(t.Et<0||t.It<0)throw Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.bf.Mr(t)||(this.bf=t,this.kf=!0,this.Nf.resizeCanvas({width:t.Et,height:t.It}),this.Rf.resizeCanvas({width:t.Et,height:t.It}),this.kf=!1,this.wp.style.width=t.Et+"px",this.wp.style.height=t.It+"px")}zp(){let t=T(this.pp);for(let i of(t.Ga(t.Ja()),t.Ga(t.Qa()),t.rl()))if(t.pe(i)){let s=i.Ct();null!==s&&t.Ga(s),i.rs()}}sp(){return this.Nf.canvas}Zf(t){if(0===t||null===this.pp)return;if(t>1&&this.zp(),null!==this.ep&&this.ep.Zf(t),null!==this.rp&&this.rp.Zf(t),1!==t){let i=i9(this.Nf.canvas);i.save(),this.Jf(i,this.Nf.pixelRatio),this.pp&&(this.Wp(i,this.Nf.pixelRatio),this.jp(i,this.Nf.pixelRatio),this.$p(i,this.Nf.pixelRatio,sv)),i.restore()}let s=i9(this.Rf.canvas);s.clearRect(0,0,Math.ceil(this.bf.Et*this.Rf.pixelRatio),Math.ceil(this.bf.It*this.Rf.pixelRatio)),this.$p(s,this.Nf.pixelRatio,sm),this.Hp(s,this.Rf.pixelRatio)}Up(){return this.ep}qp(){return this.rp}mp(){null!==this.pp&&this.pp.uo().v(this),this.pp=null}Jf(t,i){tl(t,i,()=>{let i=this.gi(),s=i.nc(),e=i.sc();s===e?tr(t,0,0,this.bf.Et,this.bf.It,e):tn(t,0,0,this.bf.Et,this.bf.It,s,e)})}Wp(t,i){let s=T(this.pp),e=s.co().vl().vt(s.qt(),s.Ut());null!==e&&(t.save(),e.U(t,i,!1),t.restore())}jp(t,i){let s=this.gi().Eu();this.Yp(t,i,sv,sd,s),this.Yp(t,i,sv,sp,s)}Hp(t,i){this.Yp(t,i,sv,sp,this.gi().Iu())}$p(t,i,s){let e=T(this.pp).va();for(let h of e)this.Yp(t,i,s,sd,h);for(let l of e)this.Yp(t,i,s,sp,l)}Yp(t,i,s,e,h){let l=T(this.pp),r=s(h,l),n=l.qt(),o=l.Ut(),a=l.jt().Du(),u=null!==a&&a.Ou===h,c=null!==a&&u&&void 0!==a.Pp?a.Pp.Ge:void 0;for(let f of r){let d=f.vt(n,o);null!==d&&(t.save(),e(d,t,i,u,c),t.restore())}}Bp(t,i,s){for(let e of t){let h=e.vt(this.bf.It,this.bf.Et);if(null!==h&&h.Ze){let l=h.Ze(i,s);if(null!==l)return{uf:e,Pp:l}}}return null}kp(){if(null===this.pp)return;let t=this.vp,i=this.pp.Ja().V().visible,s=this.pp.Qa().V().visible;i||null===this.ep||(this.bp.removeChild(this.ep.Wf()),this.ep.M(),this.ep=null),s||null===this.rp||(this.gp.removeChild(this.rp.Wf()),this.rp.M(),this.rp=null);let e=t.jt().Zu();i&&null===this.ep&&(this.ep=new sf(this,t.V().layout,e,"left"),this.bp.appendChild(this.ep.Wf())),s&&null===this.rp&&(this.rp=new sf(this,t.V().layout,e,"right"),this.gp.appendChild(this.rp.Wf()))}Xp(t){return t.lf&&this._p||null!==this.up}Kp(t){return Math.max(0,Math.min(t,this.bf.Et-1))}Zp(t){return Math.max(0,Math.min(t,this.bf.It-1))}Tp(t,i){this.gi().Yu(this.Kp(t),this.Zp(i),T(this.pp))}Ap(){this.gi().Xu()}Lp(){this.cp&&(this.up=null,this.Ap())}Rp(t,i){this.up=t,this.cp=!1,this.Tp(i.x,i.y);let s=this.gi().Iu();this.dp={x:s.Yt(),y:s.Xt()}}gi(){return this.vp.jt()}Gp(){let t=this.gi(),i=this.Kf(),s=i.ji();t.ho(i,s),t.Hu(),this.hp=null,this.lp=!1}Np(t){if(!this.lp)return;let i=performance.now();if(null!==this.fp&&this.fp.De(t.if,i),null===this.fp||this.fp.gc(i))return void this.Gp();let s=this.gi(),e=s.gt(),h=this.fp,l=()=>{if(h.Sc())return;let t=performance.now(),i=h.gc(t);if(!h.Sc()){let r=e.N_();s.$u(h.bc(t)),r===e.N_()&&(i=!0,this.fp=null)}i?this.Gp():requestAnimationFrame(l)};requestAnimationFrame(l)}Cp(){this.up=null}Dp(){if(this.pp){if(this.Ip(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)T(document.activeElement).blur();else{let t=document.getSelection();null!==t&&t.removeAllRanges()}this.pp.ji().vi()||this.gi().gt().vi()}}Op(t){if(null===this.pp)return;let i=this.gi();if(i.gt().vi())return;let s=this.vp.V(),e=s.handleScroll,h=s.kineticScroll;if((!e.pressedMouseMove||t.lf)&&(!e.horzTouchDrag&&!e.vertTouchDrag||!t.lf))return;let l=this.pp.ji(),r=performance.now();null!==this.hp||this.Xp(t)||(this.hp={x:t.Kd,y:t.Zd,Ao:r,if:t.if,sf:t.sf}),null!==this.fp&&this.fp.wc(t.if,r),null===this.hp||this.lp||this.hp.x===t.Kd&&this.hp.y===t.Zd||(null===this.fp&&(t.lf&&h.touch||!t.lf&&h.mouse)&&(this.fp=new ss(.2,7,.997,15),this.fp.wc(this.hp.if,this.hp.Ao),this.fp.wc(t.if,r)),l.vi()||i.eo(this.pp,l,t.sf),i.ju(t.if),this.lp=!0),this.lp&&(l.vi()||i.ro(this.pp,l,t.sf),i.$u(t.if))}Ip(){let t=performance.now(),i=null===this.fp||this.fp.gc(t);null!==this.fp&&(i||this.Gp()),null!==this.fp&&(this.fp.yc(),this.fp=null)}constructor(t,i){this.bf=new i4(0,0),this.ep=null,this.rp=null,this.hp=null,this.lp=!1,this.ap=new A,this.op=0,this._p=!1,this.up=null,this.cp=!1,this.dp=null,this.fp=null,this.kf=!1,this.xf=()=>{this.kf||null===this.pp||this.gi().Wr()},this.Df=()=>{this.kf||null===this.pp||this.gi().Wr()},this.vp=t,this.pp=i,this.pp.uo().l(this.mp.bind(this),this,!0),this.wp=document.createElement("td"),this.wp.style.padding="0",this.wp.style.position="relative";let s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.bp=document.createElement("td"),this.bp.style.padding="0",this.gp=document.createElement("td"),this.gp.style.padding="0",this.wp.appendChild(s),this.Nf=st(s,new i4(16,16)),this.Nf.subscribeCanvasConfigured(this.xf);let e=this.Nf.canvas;e.style.position="absolute",e.style.zIndex="1",e.style.left="0",e.style.top="0",this.Rf=st(s,new i4(16,16)),this.Rf.subscribeCanvasConfigured(this.Df);let h=this.Rf.canvas;h.style.position="absolute",h.style.zIndex="2",h.style.left="0",h.style.top="0",this.Mp=document.createElement("tr"),this.Mp.appendChild(this.bp),this.Mp.appendChild(this.wp),this.Mp.appendChild(this.gp),this.Sp(),this.zf=new sl(this.Rf.canvas,this,{yd:()=>null===this.up&&!this.vp.V().handleScroll.vertTouchDrag,kd:()=>null===this.up&&!this.vp.V().handleScroll.horzTouchDrag})}}class sb{M(){this.Nf.unsubscribeCanvasConfigured(this.xf),this.Nf.destroy()}Wf(){return this.Of}Fp(){return this.bf}Yf(t){if(t.Et<0||t.It<0)throw Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.bf.Mr(t)||(this.bf=t,this.Nf.resizeCanvas({width:t.Et,height:t.It}),this.Of.style.width="".concat(t.Et,"px"),this.Of.style.minWidth="".concat(t.Et,"px"),this.Of.style.height="".concat(t.It,"px"),this.ut=!0)}Zf(t){if(t<3&&!this.ut||0===this.bf.Et||0===this.bf.It)return;this.ut=!1;let i=i9(this.Nf.canvas);this.Jf(i,this.Nf.pixelRatio),this.Un(i,this.Nf.pixelRatio)}sp(){return this.Nf.canvas}Un(t,i){if(!this.Jp())return;let s=this.bf.Et;t.save(),t.fillStyle=this.Fi.timeScale.borderColor;let e=Math.floor(this.bu.V().k*i),h=this.Pf?Math.round(s*i)-e:0;t.fillRect(h,0,e,e),t.restore()}Jf(t,i){tl(t,i,()=>{tr(t,0,0,this.bf.Et,this.bf.It,this.Qp())})}constructor(t,i,s,e,h){this.ut=!0,this.bf=new i4(0,0),this.xf=()=>this.Zf(3),this.Pf="left"===t,this.bu=s.Zu,this.Fi=i,this.Jp=e,this.Qp=h,this.Of=document.createElement("div"),this.Of.style.width="25px",this.Of.style.height="100%",this.Of.style.overflow="hidden",this.Nf=st(this.Of,new i4(16,16)),this.Nf.subscribeCanvasConfigured(this.xf)}}function sM(t,i){return t.$o>i.$o?t:i}class sw{M(){this.zf.M(),null!==this.tv&&this.tv.M(),null!==this.iv&&this.iv.M(),this.Rf.unsubscribeCanvasConfigured(this.Df),this.Rf.destroy(),this.Nf.unsubscribeCanvasConfigured(this.xf),this.Nf.destroy()}Wf(){return this.ev}ov(){return this.tv}_v(){return this.iv}Bd(t){if(this.sv)return;this.sv=!0;let i=this.vp.jt();!i.gt().vi()&&this.vp.V().handleScale.axisPressedMouseMove.time&&i.Fu(t.if)}Id(t){this.Bd(t)}Vd(){let t=this.vp.jt();!t.gt().vi()&&this.sv&&(this.sv=!1,this.vp.V().handleScale.axisPressedMouseMove.time&&t.qu())}Td(t){let i=this.vp.jt();!i.gt().vi()&&this.vp.V().handleScale.axisPressedMouseMove.time&&i.Uu(t.if)}xd(t){this.Td(t)}Nd(){this.sv=!1;let t=this.vp.jt();t.gt().vi()&&!this.vp.V().handleScale.axisPressedMouseMove.time||t.qu()}Pd(){this.Nd()}_d(){this.vp.V().handleScale.axisDoubleClickReset&&this.vp.jt().ys()}hd(){this._d()}wd(){this.vp.jt().V().handleScale.axisPressedMouseMove.time&&this.np(1)}Yd(){this.np(0)}Fp(){return this.bf}uv(){return this.nv}cv(t,i,s){this.bf&&this.bf.Mr(t)||(this.bf=t,this.kf=!0,this.Nf.resizeCanvas({width:t.Et,height:t.It}),this.Rf.resizeCanvas({width:t.Et,height:t.It}),this.kf=!1,this.Of.style.width=t.Et+"px",this.Of.style.height=t.It+"px",this.nv.m(t)),null!==this.tv&&this.tv.Yf(new i4(i,t.It)),null!==this.iv&&this.iv.Yf(new i4(s,t.It))}dv(){let t=this.fv();return Math.ceil(t.k+t.C+t.T+t.I+t.N)}dt(){this.vp.jt().gt().pl()}sp(){return this.Nf.canvas}Zf(t){if(0===t)return;if(1!==t){let i=i9(this.Nf.canvas);this.Jf(i,this.Nf.pixelRatio),this.Un(i,this.Nf.pixelRatio),this.Qf(i,this.Nf.pixelRatio),null!==this.tv&&this.tv.Zf(t),null!==this.iv&&this.iv.Zf(t)}let s=i9(this.Rf.canvas),e=this.Rf.pixelRatio;s.clearRect(0,0,Math.ceil(this.bf.Et*e),Math.ceil(this.bf.It*e)),this.pv([this.vp.jt().Iu()],s,e)}Jf(t,i){tl(t,i,()=>{tr(t,0,0,this.bf.Et,this.bf.It,this.vp.jt().sc())})}Un(t,i){if(this.vp.V().timeScale.borderVisible){t.save(),t.fillStyle=this.vv();let s=Math.max(1,Math.floor(this.fv().k*i));t.fillRect(0,0,Math.ceil(this.bf.Et*i),s),t.restore()}}Qf(t,i){let s=this.vp.jt().gt(),e=s.pl();if(!e||0===e.length)return;let h=e.reduce(sM,e[0]).$o;h>30&&h<50&&(h=30),t.save(),t.strokeStyle=this.vv();let l=this.fv(),r=l.k+l.C+l.I+l.T-l.L;t.textAlign="center",t.fillStyle=this.vv();let n=Math.floor(this.fv().k*i),o=Math.max(1,Math.floor(i)),a=Math.floor(.5*i),u=s.V();if(u.borderVisible&&u.ticksVisible){t.beginPath();let c=Math.round(l.C*i);for(let f=e.length;f--;){let d=Math.round(e[f]._l*i);t.rect(d-a,n,o,c)}t.fill()}t.fillStyle=this.j(),tl(t,i,()=>{for(let i of(t.font=this.mv(),e))if(i.$o<h){let s=i.E_?this.wv(t,i._l,i.Pl):i._l;t.fillText(i.Pl,s,r)}for(let l of(t.font=this.bv(),e))if(l.$o>=h){let n=l.E_?this.wv(t,l._l,l.Pl):l._l;t.fillText(l.Pl,n,r)}}),t.restore()}wv(t,i,s){let e=this.Mf.Qt(t,s),h=Math.floor(i-e/2)+.5;return h<0?i+=Math.abs(0-h):h+e>this.bf.Et&&(i-=Math.abs(this.bf.Et-(h+e))),i}pv(t,i,s){let e=this.fv();for(let h of t)for(let l of h.Di())i.save(),l.vt().U(i,e,s),i.restore()}vv(){return this.vp.V().timeScale.borderColor}j(){return this.Fi.textColor}F(){return this.Fi.fontSize}mv(){return H(this.F(),this.Fi.fontFamily)}bv(){return H(this.F(),this.Fi.fontFamily,"bold")}fv(){null===this.S&&(this.S={k:1,L:NaN,I:NaN,N:NaN,bi:NaN,C:3,T:NaN,D:"",wi:new t1});let t=this.S,i=this.mv();if(t.D!==i){let s=this.F();t.T=s,t.D=i,t.I=Math.ceil(s/2.5),t.N=t.I,t.bi=Math.ceil(s/2),t.L=Math.round(this.F()/5),t.wi.he()}return this.S}np(t){this.Of.style.cursor=1===t?"ew-resize":"default"}av(){let t=this.vp.jt(),i=t.V();i.leftPriceScale.visible||null===this.tv||(this.rv.removeChild(this.tv.Wf()),this.tv.M(),this.tv=null),i.rightPriceScale.visible||null===this.iv||(this.hv.removeChild(this.iv.Wf()),this.iv.M(),this.iv=null);let s={Zu:this.vp.jt().Zu()},e=()=>t.sc();i.leftPriceScale.visible&&null===this.tv&&(this.tv=new sb("left",i,s,()=>i.leftPriceScale.borderVisible&&t.gt().V().borderVisible,e),this.rv.appendChild(this.tv.Wf())),i.rightPriceScale.visible&&null===this.iv&&(this.iv=new sb("right",i,s,()=>i.leftPriceScale.borderVisible&&t.gt().V().borderVisible,e),this.hv.appendChild(this.iv.Wf()))}constructor(t){this.tv=null,this.iv=null,this.S=null,this.sv=!1,this.bf=new i4(0,0),this.nv=new A,this.Mf=new t1(5),this.kf=!1,this.xf=()=>{this.kf||this.vp.jt().Wr()},this.Df=()=>{this.kf||this.vp.jt().Wr()},this.vp=t,this.Fi=t.V().layout,this.ev=document.createElement("tr"),this.rv=document.createElement("td"),this.rv.style.padding="0",this.hv=document.createElement("td"),this.hv.style.padding="0",this.Of=document.createElement("td"),this.Of.style.height="25px",this.Of.style.padding="0",this.lv=document.createElement("div"),this.lv.style.width="100%",this.lv.style.height="100%",this.lv.style.position="relative",this.lv.style.overflow="hidden",this.Of.appendChild(this.lv),this.Nf=st(this.lv,new i4(16,16)),this.Nf.subscribeCanvasConfigured(this.xf);let i=this.Nf.canvas;i.style.position="absolute",i.style.zIndex="1",i.style.left="0",i.style.top="0",this.Rf=st(this.lv,new i4(16,16)),this.Rf.subscribeCanvasConfigured(this.Df);let s=this.Rf.canvas;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.ev.appendChild(this.rv),this.ev.appendChild(this.Of),this.ev.appendChild(this.hv),this.av(),this.vp.jt().$a().l(this.av.bind(this),this),this.zf=new sl(this.Rf.canvas,this,{yd:()=>!0,kd:()=>!1})}}class sN{jt(){return this.gi}V(){return this.Fi}Ev(){return this.gv}Iv(){return this.Ov}M(){for(let t of(this.ev.removeEventListener("wheel",this.Tv),0!==this.Mv&&window.cancelAnimationFrame(this.Mv),this.gi.Lu().v(this),this.gi.gt().U_().v(this),this.gi.$a().v(this),this.gi.M(),this.gv))this.Cv.removeChild(t.Wf()),t.Ep().v(this),t.M();this.gv=[],T(this.Ov).M(),null!==this.ev.parentElement&&this.ev.parentElement.removeChild(this.ev),this.vu.M(),this.ap.M()}Nv(t,i){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.Rl===i&&this.oe===t)return;this.Rl=i,this.oe=t;let e=i+"px",h=t+"px";T(this.ev).style.height=e,T(this.ev).style.width=h,this.Cv.style.height=e,this.Cv.style.width=h,s?this.Lv(new tg(3)):this.gi.Rh()}Zf(t){void 0===t&&(t=new tg(3));for(let i=0;i<this.gv.length;i++)this.gv[i].Zf(t.bs(i).ps);this.Fi.timeScale.visible&&this.Ov.Zf(t.ws())}zr(t){this.gi.zr(t),this.Av();let i=t.width||this.oe,s=t.height||this.Rl;this.Nv(i,s)}Ep(){return this.ap}Lu(){return this.vu}Bv(){null!==this.kv&&(this.Lv(this.kv),this.kv=null);let t=this.gv[0],i=i7(document,new i4(this.oe,this.Rl)),s=i9(i),e=i8(i);return tl(s,e,()=>{let i=0,e=0,h=t=>{for(let h=0;h<this.gv.length;h++){let l=this.gv[h],r=l.Fp().It,n=T("left"===t?l.Up():l.qp()),o=n.sp();s.drawImage(o,i,e,n.Xf(),r),e+=r}};this.Vv()&&(h("left"),i=T(t.Up()).Xf()),e=0;for(let l=0;l<this.gv.length;l++){let r=this.gv[l],n=r.Fp(),o=r.sp();s.drawImage(o,i,e,n.Et,n.It),e+=n.It}i+=t.Fp().Et,this.Fv()&&(e=0,h("right"));let a=t=>{let h=T("left"===t?this.Ov.ov():this.Ov._v()),l=h.Fp(),r=h.sp();s.drawImage(r,i,e,l.Et,l.It)};if(this.Fi.timeScale.visible){i=0,this.Vv()&&(a("left"),i=T(t.Up()).Xf());let u=this.Ov.Fp(),c=this.Ov.sp();s.drawImage(c,i,e,u.Et,u.It),this.Fv()&&(i+=t.Fp().Et,a("right"),s.restore())}}),i}zv(t){return("left"!==t||this.Vv())&&("right"!==t||this.Fv())&&0!==this.gv.length?T("left"===t?this.gv[0].Up():this.gv[0].qp()).Xf():0}Wv(){let t=0,i=0,s=0;for(let e of this.gv)this.Vv()&&(i=Math.max(i,T(e.Up()).Uf())),this.Fv()&&(s=Math.max(s,T(e.qp()).Uf())),t+=e.Ha();let h=this.oe,l=this.Rl,r=Math.max(h-i-s,0),n=this.Fi.timeScale.visible,o=n?this.Ov.dv():0;o%2&&(o+=1);let a=0+o,u=l<a?0:l-a,c=u/t,f=0;for(let d=0;d<this.gv.length;++d){let p=this.gv[d];p.yp(this.gi.Au()[d]);let v=0;v=Math.max(d===this.gv.length-1?u-f:Math.round(p.Ha()*c),2),f+=v,p.Yf(new i4(r,v)),this.Vv()&&p.Vp(i,"left"),this.Fv()&&p.Vp(s,"right"),p.Kf()&&this.gi.Bu(p.Kf(),v)}this.Ov.cv(new i4(n?r:0,o),n?i:0,n?s:0),this.gi.qa(r),this.Sv!==i&&(this.Sv=i),this.yv!==s&&(this.yv=s)}Dv(t){let i=t.deltaX/100,s=-t.deltaY/100;if(0!==i&&this.Fi.handleScroll.mouseWheel||0!==s&&this.Fi.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:i*=120,s*=120;break;case t.DOM_DELTA_LINE:i*=32,s*=32}if(0!==s&&this.Fi.handleScale.mouseWheel){let e=Math.sign(s)*Math.min(1,Math.abs(s)),h=t.clientX-this.ev.getBoundingClientRect().left;this.jt().zu(h,e)}0!==i&&this.Fi.handleScroll.mouseWheel&&this.jt().Wu(-80*i)}}Lv(t){var i;let s=t.ws();3===s&&this.jv(),3!==s&&2!==s||(this.$v(t),this.Hv(t),this.Ov.dt(),this.gv.forEach(t=>{t.xp()}),3===(null===(i=this.kv)||void 0===i?void 0:i.ws())&&(this.kv.Ts(t),this.jv(),this.$v(this.kv),this.Hv(this.kv),t=this.kv,this.kv=null)),this.Zf(t)}Hv(t){let i=t.Cs();for(let s of i)this.Ds(s)}$v(t){let i=this.gi.Au();for(let s=0;s<i.length;s++)t.bs(s).vs&&i[s].oo()}Ds(t){let i=this.gi.gt();switch(t.Ms){case 0:i.Y_();break;case 1:i.X_(t.Tt);break;case 2:i.ks(t.Tt);break;case 3:i.xs(t.Tt);break;case 4:i.I_()}}wu(t){null!==this.kv?this.kv.Ts(t):this.kv=t,this.xv||(this.xv=!0,this.Mv=window.requestAnimationFrame(()=>{if(this.xv=!1,this.Mv=0,null!==this.kv){let t=this.kv;this.kv=null,this.Lv(t)}}))}jv(){this.Rv()}Rv(){let t=this.gi.Au(),i=t.length,s=this.gv.length;for(let e=i;e<s;e++){let h=F(this.gv.pop());this.Cv.removeChild(h.Wf()),h.Ep().v(this),h.M()}for(let l=s;l<i;l++){let r=new sg(this,t[l]);r.Ep().l(this.Uv.bind(this),this),this.gv.push(r),this.Cv.insertBefore(r.Wf(),this.Ov.Wf())}for(let n=0;n<i;n++){let o=t[n],a=this.gv[n];a.Kf()!==o?a.yp(o):a.Sp()}this.Av(),this.Wv()}qv(t,i){var s;let e;let h=new Map;if(null!==t&&this.gi.ft().forEach(i=>{let s=i._s().rh(t);null!==s&&h.set(i,s)}),null!==t){let l=null===(s=this.gi.gt().Mi(t))||void 0===s?void 0:s.Ho;void 0!==l&&(e=l)}let r=this.jt().Du(),n=null!==r&&r.Ou instanceof iC?r.Ou:void 0,o=null!==r&&void 0!==r.Pp?r.Pp.Qe:void 0;return{rt:e,pn:null!=t?t:void 0,Yv:null!=i?i:void 0,Xv:n,Kv:h,Zv:o}}Uv(t,i){this.ap.m(()=>this.qv(t,i))}Pv(t,i){this.vu.m(()=>this.qv(t,i))}Av(){let t=this.Fi.timeScale.visible?"":"none";this.Ov.Wf().style.display=t}Vv(){return this.gv[0].Kf().Ja().V().visible}Fv(){return this.gv[0].Kf().Qa().V().visible}constructor(t,i){var s;this.gv=[],this.Mv=0,this.Rl=0,this.oe=0,this.Sv=0,this.yv=0,this.kv=null,this.xv=!1,this.ap=new A,this.vu=new A,this.Fi=i,this.ev=document.createElement("div"),this.ev.classList.add("tv-lightweight-charts"),this.ev.style.overflow="hidden",this.ev.style.width="100%",this.ev.style.height="100%",(s=this.ev).style.userSelect="none",s.style.webkitUserSelect="none",s.style.msUserSelect="none",s.style.MozUserSelect="none",s.style.webkitTapHighlightColor="transparent",this.Cv=document.createElement("table"),this.Cv.setAttribute("cellspacing","0"),this.ev.appendChild(this.Cv),this.Tv=this.Dv.bind(this),this.ev.addEventListener("wheel",this.Tv,{passive:!1}),this.gi=new i3(this.wu.bind(this),this.Fi),this.jt().Lu().l(this.Pv.bind(this),this),this.Ov=new sw(this),this.Cv.appendChild(this.Ov.Wf());let e=this.Fi.width,h=this.Fi.height;if(0===e||0===h){let l=t.getBoundingClientRect();0===e&&(e=Math.floor(l.width),e-=e%2),0===h&&(h=Math.floor(l.height),h-=h%2)}this.Nv(e,h),this.Rv(),t.appendChild(this.ev),this.Av(),this.gi.gt().U_().l(this.gi.Rh.bind(this.gi),this),this.gi.$a().l(this.gi.Rh.bind(this.gi),this)}}function sy(t,i,s,e){let h=s.value;return{pn:i,rt:t,Tt:[h,h,h,h],Ho:e}}function sC(t,i,s,e){let h=s.value,l={pn:i,rt:t,Tt:[h,h,h,h],Ho:e};return"color"in s&&void 0!==s.color&&(l.O=s.color),l}function sS(t){return void 0!==t.Tt}function sx(t){return(i,s,e,h)=>void 0===e.open&&void 0===e.value?{rt:i,pn:s,Ho:h}:t(i,s,e,h)}let s_={Candlestick:sx(function(t,i,s,e){let h={pn:i,rt:t,Tt:[s.open,s.high,s.low,s.close],Ho:e};return"color"in s&&void 0!==s.color&&(h.O=s.color),"borderColor"in s&&void 0!==s.borderColor&&(h.Dt=s.borderColor),"wickColor"in s&&void 0!==s.wickColor&&(h.Xn=s.wickColor),h}),Bar:sx(function(t,i,s,e){let h={pn:i,rt:t,Tt:[s.open,s.high,s.low,s.close],Ho:e};return"color"in s&&void 0!==s.color&&(h.O=s.color),h}),Area:sx(sy),Baseline:sx(sy),Histogram:sx(sC),Line:sx(sC)};function sF(t){return 60*t*6e4}function sT(t){return 60*t*1e3}let sk=[{Gv:1e3,$o:10},{Gv:sT(1),$o:20},{Gv:sT(5),$o:21},{Gv:sT(30),$o:22},{Gv:sF(1),$o:30},{Gv:sF(3),$o:31},{Gv:sF(6),$o:32},{Gv:sF(12),$o:33}];function sE(t,i){if(t.getUTCFullYear()!==i.getUTCFullYear())return 70;if(t.getUTCMonth()!==i.getUTCMonth())return 60;if(t.getUTCDate()!==i.getUTCDate())return 50;for(let s=sk.length-1;s>=0;--s)if(Math.floor(i.getTime()/sk[s].Gv)!==Math.floor(t.getTime()/sk[s].Gv))return sk[s].$o;return 0}function sI(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===t.length)return;let s=0===i?null:t[i-1].rt.Ao,e=null!==s?new Date(1e3*s):null,h=0;for(let l=i;l<t.length;++l){let r=t[l],n=new Date(1e3*r.rt.Ao);null!==e&&(r.jo=sE(n,e)),h+=r.rt.Ao-(s||r.rt.Ao),s=r.rt.Ao,e=n}if(0===i&&t.length>1){let o=Math.ceil(h/(t.length-1)),a=new Date(1e3*(t[0].rt.Ao-o));t[0].jo=sE(new Date(1e3*t[0].rt.Ao),a)}}function sO(t){if(!i6(t))throw Error("time must be of type BusinessDay");let i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Ao:Math.round(i.getTime()/1e3),Ro:t}}function sV(t){if(!U(t))throw Error("time must be of type isUTCTimestamp");return{Ao:t}}function sR(t){return 0===t.length?null:i6(t[0].time)?sO:sV}function sP(t){return U(t)?sV(t):i6(t)?sO(t):sO(sL(t))}function sL(t){let i=new Date(t);if(isNaN(i.getTime()))throw Error("Invalid date string=".concat(t,", expected format=yyyy-mm-dd"));return{day:i.getUTCDate(),month:i.getUTCMonth()+1,year:i.getUTCFullYear()}}function sG(t){J(t.time)&&(t.time=sL(t.time))}function sj(t){return{pn:0,Jv:new Map,$h:t}}function sA(t){if(void 0!==t&&0!==t.length)return{Qv:t[0].rt.Ao,tm:t[t.length-1].rt.Ao}}function sD(t){let i;return t.forEach(t=>{void 0===i&&(i=t.Ho)}),F(i)}function sU(t){void 0===t.Ho&&(t.Ho=t.time)}class sB{M(){this.im.clear(),this.sm.clear(),this.nm.clear(),this.rm=[]}hm(t,i){let s=0!==this.im.size,e=!1,h=this.sm.get(t);if(void 0!==h){if(1===this.sm.size)s=!1,e=!0,this.im.clear();else for(let l of this.rm)l.pointData.Jv.delete(t)&&(e=!0)}let r=[];if(0!==i.length){i.forEach(t=>sU(t)),function(t){t.forEach(sG)}(i);let n=T(sR(i)),o=s_[t.$r()];r=i.map(i=>{let s=n(i.time),h=this.im.get(s.Ao);void 0===h&&(h=sj(s),this.im.set(s.Ao,h),e=!0);let l=o(s,h.pn,i,i.Ho);return h.Jv.set(t,l),l})}s&&this.lm(),this.am(t,r);let a=-1;if(e){let u=[];this.im.forEach(t=>{u.push({jo:0,rt:t.$h,pointData:t,Ho:sD(t.Jv)})}),u.sort((t,i)=>t.rt.Ao-i.rt.Ao),a=this.om(u)}return this._m(t,a,function(t,i){let s=sA(t),e=sA(i);if(void 0!==s&&void 0!==e)return{Lh:s.tm>=e.tm&&s.Qv>=e.Qv}}(this.sm.get(t),h))}Qu(t){return this.hm(t,[])}um(t,i){sU(i),sG(i);let s=T(sR([i]))(i.time),e=this.nm.get(t);if(void 0!==e&&s.Ao<e.Ao)throw Error("Cannot update oldest data, last time=".concat(e.Ao,", new time=").concat(s.Ao));let h=this.im.get(s.Ao),l=void 0===h;void 0===h&&(h=sj(s),this.im.set(s.Ao,h));let r=s_[t.$r()](s,h.pn,i,i.Ho);h.Jv.set(t,r),this.dm(t,r);let n={Lh:sS(r)};if(!l)return this._m(t,-1,n);let o={jo:0,rt:h.$h,pointData:h,Ho:sD(h.Jv)},a=tE(this.rm,o.rt.Ao,(t,i)=>t.rt.Ao<i);this.rm.splice(a,0,o);for(let u=a;u<this.rm.length;++u)sJ(this.rm[u].pointData,u);return sI(this.rm,a),this._m(t,a,n)}dm(t,i){let s=this.sm.get(t);void 0===s&&(s=[],this.sm.set(t,s));let e=0!==s.length?s[s.length-1]:null;null===e||i.rt.Ao>e.rt.Ao?sS(i)&&s.push(i):sS(i)?s[s.length-1]=i:s.splice(-1,1),this.nm.set(t,i.rt)}am(t,i){0!==i.length?(this.sm.set(t,i.filter(sS)),this.nm.set(t,i[i.length-1].rt)):(this.sm.delete(t),this.nm.delete(t))}lm(){for(let t of this.rm)0===t.pointData.Jv.size&&this.im.delete(t.rt.Ao)}om(t){let i=-1;for(let s=0;s<this.rm.length&&s<t.length;++s){let e=this.rm[s],h=t[s];if(e.rt.Ao!==h.rt.Ao){i=s;break}h.jo=e.jo,sJ(h.pointData,s)}if(-1===i&&this.rm.length!==t.length&&(i=Math.min(this.rm.length,t.length)),-1===i)return -1;for(let l=i;l<t.length;++l)sJ(t[l].pointData,l);return sI(t,i),this.rm=t,i}fm(){if(0===this.sm.size)return null;let t=0;return this.sm.forEach(i=>{0!==i.length&&(t=Math.max(t,i[i.length-1].pn))}),t}_m(t,i,s){let e={pm:new Map,gt:{C_:this.fm()}};if(-1!==i)this.sm.forEach((i,h)=>{e.pm.set(h,{ye:i,vm:h===t?s:void 0})}),this.sm.has(t)||e.pm.set(t,{ye:[],vm:s}),e.gt.wm=this.rm,e.gt.bm=i;else{let h=this.sm.get(t);e.pm.set(t,{ye:h||[],vm:s})}return e}constructor(){this.im=new Map,this.sm=new Map,this.nm=new Map,this.rm=[]}}function sJ(t,i){t.pn=i,t.Jv.forEach(t=>{t.pn=i})}function sz(t){return{value:t.Tt[3],time:t.Ho}}function sK(t){return{open:t.Tt[0],high:t.Tt[1],low:t.Tt[2],close:t.Tt[3],time:t.Ho}}let sW={Area:sz,Line:sz,Baseline:sz,Histogram:function(t){return{value:t.Tt[3],color:t.O,time:t.Ho}},Bar:sK,Candlestick:sK},sq={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:""};class sZ{applyOptions(t){this.Ir.zr(t)}options(){return this.Ir.V()}gm(){return this.Ir}constructor(t){this.Ir=t}}class sH{priceFormatter(){return this.Gs.Zh()}priceToCoordinate(t){let i=this.Gs.yt();return null===i?null:this.Gs.Ct().xt(t,i.Tt)}coordinateToPrice(t){let i=this.Gs.yt();return null===i?null:this.Gs.Ct().$i(t,i.Tt)}barsInLogicalRange(t){if(null===t)return null;let i=new iQ(new iH(t.from,t.to)).Ko(),s=this.Gs._s();if(s.vi())return null;let e=s.rh(i.Hs(),1),h=s.rh(i.Us(),-1),l=T(s.sh()),r=T(s.os());if(null!==e&&null!==h&&e.pn>h.pn)return{barsBefore:t.from-l,barsAfter:r-t.to};let n={barsBefore:null===e||e.pn===l?t.from-l:e.pn-l,barsAfter:null===h||h.pn===r?r-t.to:r-h.pn};return null!==e&&null!==h&&(n.from=e.rt.Ro||e.rt.Ao,n.to=h.rt.Ro||h.rt.Ao),n}setData(t){this.Gs.$r(),this.Mm.ym(this.Gs,t)}update(t){this.Gs.$r(),this.Mm.km(this.Gs,t)}dataByIndex(t,i){let s=this.Gs._s().rh(t,i);return null===s?null:sW[this.seriesType()](s)}setMarkers(t){let i=t.map(t=>Object.assign(Object.assign({},t),{originalTime:t.time,time:sP(t.time)}));this.Gs.Vh(i)}markers(){return this.Gs.Fh().map(t=>{let{originalTime:i,time:s}=t,e=function(t,i){var s={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&0>i.indexOf(e)&&(s[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var h=0;for(e=Object.getOwnPropertySymbols(t);h<e.length;h++)0>i.indexOf(e[h])&&Object.prototype.propertyIsEnumerable.call(t,e[h])&&(s[e[h]]=t[e[h]])}return s}(t,["originalTime","time"]);return Object.assign({time:i},e)})}applyOptions(t){this.Gs.zr(t)}options(){return K(this.Gs.V())}priceScale(){return this.Sm.priceScale(this.Gs.Ct().il())}createPriceLine(t){let i=D(K(sq),t),s=this.Gs.zh(i);return new sZ(s)}removePriceLine(t){this.Gs.Wh(t.gm())}seriesType(){return this.Gs.$r()}constructor(t,i,s){this.Gs=t,this.Mm=i,this.Sm=s}}class sY extends sH{applyOptions(t){i5(t),super.applyOptions(t)}}let s$={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!0,scaleMargins:{bottom:.1,top:.2}},sQ={width:0,height:0,layout:{background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:11,fontFamily:Z},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},overlayPriceScales:Object.assign({},s$),leftPriceScale:Object.assign(Object.assign({},s$),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},s$),{visible:!0}),timeScale:{rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,ticksVisible:!0},watermark:{color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:Z,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"},localization:{locale:navigator.language,dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}},sX={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},s0={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},s1={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},s2={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},s3={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},s5={color:"#26a69a",base:0},s6={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};class s4{applyOptions(t){this.xm.jt().Nu(this.Cm,t)}options(){return this.fi().V()}width(){return tm(this.Cm)?this.xm.zv(this.Cm):0}fi(){return T(this.xm.jt().Ru(this.Cm)).Ct}constructor(t,i){this.xm=t,this.Cm=i}}class s8{M(){this.Ia.j_().v(this),this.Ia.H_().v(this),this.Ov.uv().v(this),this.Tm.M(),this.r_.M(),this.nv.M()}scrollPosition(){return this.Ia.N_()}scrollToPosition(t,i){i?this.Ia.W_(t,1e3):this.gi.xs(t)}scrollToRealTime(){this.Ia.z_()}getVisibleRange(){var t,i;let s=this.Ia.b_();return null===s?null:{from:null!==(t=s.from.Ro)&&void 0!==t?t:s.from.Ao,to:null!==(i=s.to.Ro)&&void 0!==i?i:s.to.Ao}}setVisibleRange(t){let i={from:sP(t.from),to:sP(t.to)},s=this.Ia.y_(i);this.gi.tc(s)}getVisibleLogicalRange(){let t=this.Ia.w_();return null===t?null:{from:t.Hs(),to:t.Us()}}setVisibleLogicalRange(t){_(t.from<=t.to,"The from index cannot be after the to index."),this.gi.tc(t)}resetTimeScale(){this.gi.ys()}fitContent(){this.gi.Y_()}logicalToCoordinate(t){let i=this.gi.gt();return i.vi()?null:i.Ot(t)}coordinateToLogical(t){return this.Ia.vi()?null:this.Ia.T_(t)}timeToCoordinate(t){let i=sP(t),s=this.Ia.nl(i,!1);return null===s?null:this.Ia.Ot(s)}coordinateToTime(t){var i;let s=this.gi.gt(),e=s.T_(t),h=s.Hi(e);return null===h?null:null!==(i=h.Ro)&&void 0!==i?i:h.Ao}width(){return this.Ov.Fp().Et}height(){return this.Ov.Fp().It}subscribeVisibleTimeRangeChange(t){this.Tm.l(t)}unsubscribeVisibleTimeRangeChange(t){this.Tm.p(t)}subscribeVisibleLogicalRangeChange(t){this.r_.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.r_.p(t)}subscribeSizeChange(t){this.nv.l(t)}unsubscribeSizeChange(t){this.nv.p(t)}applyOptions(t){this.Ia.zr(t)}options(){return K(this.Ia.V())}Dm(){this.Tm.g()&&this.Tm.m(this.getVisibleRange())}Pm(){this.r_.g()&&this.r_.m(this.getVisibleLogicalRange())}Om(t){this.nv.m(t.Et,t.It)}constructor(t,i){this.Tm=new A,this.r_=new A,this.nv=new A,this.gi=t,this.Ia=t.gt(),this.Ov=i,this.Ia.j_().l(this.Dm.bind(this)),this.Ia.H_().l(this.Pm.bind(this)),this.Ov.uv().l(this.Om.bind(this))}}function s9(t){if(void 0===t||"custom"===t.type)return;let i=t;void 0!==i.minMove&&void 0===i.precision&&(i.precision=function(t){if(t>=1)return 0;let i=0;for(;i<8;i++){let s=Math.round(t);if(1e-8>Math.abs(s-t))break;t*=10}return i}(i.minMove))}function s7(t){return function(t){if(z(t.handleScale)){let i=t.handleScale;t.handleScale={axisDoubleClickReset:i,axisPressedMouseMove:{time:i,price:i},mouseWheel:i,pinch:i}}else if(void 0!==t.handleScale&&z(t.handleScale.axisPressedMouseMove)){let s=t.handleScale.axisPressedMouseMove;t.handleScale.axisPressedMouseMove={time:s,price:s}}let e=t.handleScroll;z(e)&&(t.handleScroll={horzTouchDrag:e,vertTouchDrag:e,mouseWheel:e,pressedMouseMove:e})}(t),t}class et{remove(){this.xm.Ep().v(this),this.xm.Lu().v(this),this.Bm.M(),this.xm.M(),this.Rm.clear(),this.Am.clear(),this.Em.M(),this.Im.M(),this.Nm.M()}resize(t,i,s){this.xm.Nv(t,i,s)}addAreaSeries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s9(t.priceFormat);let i=D(K(s6),s2,t),s=this.xm.jt().Gu("Area",i),e=new sH(s,this,this);return this.Rm.set(e,s),this.Am.set(s,e),e}addBaselineSeries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s9(t.priceFormat);let i=D(K(s6),K(s3),t),s=this.xm.jt().Gu("Baseline",i),e=new sH(s,this,this);return this.Rm.set(e,s),this.Am.set(s,e),e}addBarSeries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s9(t.priceFormat);let i=D(K(s6),s0,t),s=this.xm.jt().Gu("Bar",i),e=new sH(s,this,this);return this.Rm.set(e,s),this.Am.set(s,e),e}addCandlestickSeries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i5(t),s9(t.priceFormat);let i=D(K(s6),sX,t),s=this.xm.jt().Gu("Candlestick",i),e=new sY(s,this,this);return this.Rm.set(e,s),this.Am.set(s,e),e}addHistogramSeries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s9(t.priceFormat);let i=D(K(s6),s5,t),s=this.xm.jt().Gu("Histogram",i),e=new sH(s,this,this);return this.Rm.set(e,s),this.Am.set(s,e),e}addLineSeries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s9(t.priceFormat);let i=D(K(s6),s1,t),s=this.xm.jt().Gu("Line",i),e=new sH(s,this,this);return this.Rm.set(e,s),this.Am.set(s,e),e}removeSeries(t){let i=F(this.Rm.get(t)),s=this.Nm.Qu(i);this.xm.jt().Qu(i),this.Vm(s),this.Rm.delete(t),this.Am.delete(i)}ym(t,i){this.Vm(this.Nm.hm(t,i))}km(t,i){this.Vm(this.Nm.um(t,i))}subscribeClick(t){this.Em.l(t)}unsubscribeClick(t){this.Em.p(t)}subscribeCrosshairMove(t){this.Im.l(t)}unsubscribeCrosshairMove(t){this.Im.p(t)}priceScale(t){return new s4(this.xm,t)}timeScale(){return this.Bm}applyOptions(t){this.xm.zr(s7(t))}options(){return this.xm.V()}takeScreenshot(){return this.xm.Bv()}Vm(t){let i=this.xm.jt();i.Ku(t.gt.C_,t.gt.wm,t.gt.bm),t.pm.forEach((t,i)=>i.Z(t.ye,t.vm)),i.P_()}Fm(t){return F(this.Am.get(t))}Lm(t){let i=new Map;t.Kv.forEach((t,s)=>{let e=sW[s.$r()](t);_(void 0!==e.open||void 0!==e.value),i.set(this.Fm(s),e)});let s=void 0===t.Xv?void 0:this.Fm(t.Xv);return{time:t.rt,logical:t.pn,point:t.Yv,hoveredSeries:s,hoveredMarkerId:t.Zv,seriesData:i}}constructor(t,i){this.Nm=new sB,this.Rm=new Map,this.Am=new Map,this.Em=new A,this.Im=new A;let s=void 0===i?K(sQ):D(K(sQ),s7(i));this.xm=new sN(t,s),this.xm.Ep().l(t=>{this.Em.g()&&this.Em.m(this.Lm(t()))},this),this.xm.Lu().l(t=>{this.Im.g()&&this.Im.m(this.Lm(t()))},this);let e=this.xm.jt();this.Bm=new s8(e,this.xm.Iv())}}function ei(t,i){let s;if(J(t)){let e=document.getElementById(t);_(null!==e,"Cannot find element in DOM with id=".concat(t)),s=e}else s=t;return new et(s,i)}}}]);